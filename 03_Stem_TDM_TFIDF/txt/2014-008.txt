BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2014-008
Simultaneous Confidence Corridors and Variable Selection
for Generalized Additive Models
Shuzhuan Zheng* Rong Liu** Lijian Yang*
Wolfgang Karl Härdle***
* Soochow University, China and Michigan State University, USA
** University of Toledo, USA
*** Humboldt-Universität zu Berlin, Germany This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

Simultaneous Confidence Corridors and Variable Selection for Generalized Additive Models
1

Shuzhuan Zheng Center for Advanced Statistics and Econometrics Research
Soochow University Suzhou 215006, China
and Department of Statistics and Probability
Michigan State University East Lansing, MI 48824 email: zheng@stt.msu.edu
Rong Liu Department of Mathematics and Statistics
University of Toledo Toledo, OH 43606 email: rong.liu@utoledo.edu
Lijian Yang Center for Advanced Statistics and Econometrics Research
Soochow University Suzhou 215006, China email: yanglijian@suda.edu.cn
and Department of Statistics and Probability
Michigan State University East Lansing, MI 48824 email: yang@stt.msu.edu
Wolfgang K. Ha¨rdle C.A.S.E. ­ Center for Applied Statistics and Economics
Humboldt-Universita¨t zu Berlin Unter den Linden 6
10099 Berlin, Germany email: haerdle@wiwi.hu-berlin.de and
Lee Kong Chian School of Business, Singapore Management University
2

Author's Footnote: Shuzhuan Zheng is Visiting Scholar, Center for Advanced Statistics and Econometrics Research, Soochow University, Suzhou 215006, China, and Ph.D. student, Department of Statistics and Probability, Michigan State University, East Lansing, MI 48824 (E-mail: zheng@stt.msu.edu). Rong Liu is Assistant Professor, Department of Mathematics and Statistics, University of Toledo, Toledo, OH 43606 (E-mail: rong.liu@utoledo.edu). Lijian Yang is Director, Center for Advanced Statistics and Econometrics Research, Soochow University, Suzhou 215006, China, and Professor, Department of Statistics and Probability, Michigan State University, East Lansing, MI 48824 (E-mail: yanglijian@suda.edu.cn; yang@stt.msu.edu). Wolfgang K. H¨ardle is Professor, C.A.S.E. ­ Center for Applied Statistics and Economics, Humboldt-Universita¨t zu Berlin, Unter den Linden 6, 10099 Berlin, Germany, and Distinguished Visiting Professor, Lee Kong Chian School of Business, Singapore Management University (E-mail: haerdle@wiwi.hu-berlin.de). This work is supported in part by the Deutsche Forschungsgemeinschaft through the CRC 649 "Economic Risk", NSF Awards DMS 0706518, DMS 1007594, an Michigan State University Dissertation Continuation Fellowship, funding from the National University of Singapore, the Jiangsu Specially-Appointed Professor Program SR10700111, the Jiangsu Key Discipline Program (Statistics) ZY107002, National Natural Science Foundation of China award 11371272, and Research Fund for the Doctoral Program of Higher Education of China award 20133201110002.
3

Abstract In spite of the widespread use of generalized additive models (GAMs), there is no well established methodology for simultaneous inference and variable selection for the components of GAM. There is no doubt that both, inference on the marginal component functions and their selection, are essential in this additive statistical models. To this end, we establish simultaneous confidence corridors (SCCs) and a variable selection criteria through the spline-backfitted kernel smoothing techniques. To characterize the global features of each component, SCCs are constructed for testing their shapes. By extending the BIC to additive models with identity/trivial link, an asymptotically consistent BIC approach for variable selection is proposed. Our procedures are examined in simulations for its theoretical accuracy and performance, and used to forecast the default probability of listed Japanese companies. Keywords: BIC; Confidence corridor; Extreme value; Generalized additive model; Spline-backfitted kernel. JEL Classification: C35; C52; C53; G33.
4

1 INTRODUCTION

The generalized additive model (GAM) has gained popularity on addressing the curse of dimensionality

in multivariate nonparametric regressions with non-Gaussian responses. GAM was developed by Hastie

and Tibshirani (1990) for blending generalized linear model with nonparametric additive regression, which stipulates that a data set {(XiT, Yi)}ni=1 consists of iid copies of (XT, Y ) that satisfy:

E(Y

|X)

=

b

{m

(X)}

,

Var(Y

|X)

=

a

()

b

{m

(X)}

,

m

(X)

=

c

+

d
=1

m(X),

(1)

Y = b {m (X)} +  (X) ,  (X) = {Var(Y |X)}1/2

where the response Y is one of certain types, such as Bernoulli, Poisson and so forth, the vector X =

(X1, X2, ..., Xd)T consists of the predictors, m(·), 1    d are unknown smooth functions, the white

noise



satisfies

that

E ( |X )

=

0

and

E (2

) |X

=

1,

while

c

is

an

unknown

constant,

a ()

is

a

nuisance

parameter that quantifies overdispersion, and (b)-1 (·) is a known link function. In particular, if one takes

the identity/trivial link, model (1) becomes a common additive model, see Huang and Yang (2004).

It is often the case that in model (1) the probability density function of Yi conditional on Xi with

respect to a fixed -finite measure forms an exponential family:

f (Yi |Xi,  ) = exp [{Yim (Xi) - b {m (Xi)}} /a () + h (Yi, )] .

Nonetheless, such an assumption is not necessary in this paper. Instead, we only stipulate that the conditional variance and conditional mean are linked by

Var

(Y

|X

=

x)

=

a

()

b

[(b)-1

{E

(Y

|X

=

] x)}

.

For identifiability, one needs

E {m (X)} = 0, 1    d

(2)

that

leads

to

unique

additive

representations

of

m (x)

=

c

+

d
=1

m

(x).

Without

loss

of

generality,

x

take values in  = [0, 1]d.

Model (1) has numerous applications. In corporate credit rating, for instance, one is interested in

modelling how the default or non-default of a given corporate or company depends on the additive effects

of the covariates in financial statements, i.e., the response Y = 0, 1 with 1 indicating default, 0 indi-

5

cating non-default, and the predictors are selected from financial statements with a logit-link (b)-1 (x) = log {x/ (1 - x)}. Our method has been applied to 3, 472 companies in Japan within a 5-year default horizon (2005-2010), and it has been discovered that the current liabilities and stock market returns of current, 3 months and 6 months prior to default are very significant as rating factors, and the default impact of the selected factors are examined via the simultaneous confidence corridors (SCCs) in Figure 1 (a)-(c). More details of this example are contained in Section 6.
[Figure 1 about here.]
The smooth functions {m(x)}d=1 in (1) can be estimated by, for instance, kernel methods in Linton and H¨ardle (1996), Linton (1997) and Yang, Sperlich and H¨ardle (2003), B-spline methods in Stone (1986) and Xue and Liang (2010), and two-stage methods in Horowitz and Mammen (2004) and Horowitz et al. (2006). To make statistical inference on these functions individually and collectively, however, the proper tools are simultaneous confidence corridors (SCCs) and consistent variable selection criteria.
The SCC methodology has attracted attention in a variety of applied fields, see Xia (1998), Fan and Zhang (2000), Wu and Zhao (2007), Zhao and Wu (2008), Ma, Yang and Carroll (2012) among others. Capturing shape properties of the functions {m(x)}d =1 is of utmost importance. A smooth component covered entirely within SCC can be replaced by a parametric one, thereby improving the estimation efficiency, see He, Zhu and Fung (2002), He, Fung and Zhu (2005) for discussions. To our knowledge, SCCs have not been established due to a technological lack of estimators that fit in Gaussian process extreme value theory. Using the spline-backfitted kernel (SBK) methodology of Liu, Yang and H¨ardle (2013) (hereafter LYH), we extend work of univariate nonparametric regression in Bickel and Rosenblatt (1973) and H¨ardle (1989) to those of GAM. The SBK technique has been studied in Wang and Yang (2007), Wang and Yang (2009), Liu and Yang (2010) and Ma and Yang (2011) for the simpler additive model (i.e., GAM with b (x)  x) including the construction of SCC, but ours is the first work on SCC for GAM with nonlinear link.
While variable selection for nonparametric additive model has been investigated under different settings, see Wang, Li and Huang (2008), there is lack of theoretically reliable variable selection for GAM. To the best of our knowledge, only Zhang and Lin (2006) proposed the "COSSO" method for variable selection in nonparametric regression with exponential families, but without asymptotic theory. Instead, we tackle this issue by building a BIC type criterion based on spline pre-smoothing (first stage in the SBK), which is asymptotically consistent and easy to compute. Our work extends the BIC criterion for additive models
6

(trivial link) in Huang and Yang (2004). This extension is challenging since a much more complicated quasi-likelihood is employed with nonlinear link instead of the log mean squared error for trivial link. The appendix gives more details.
The rest of paper is organized as follows. The SBK estimator and its oracle property are briefly described in Section 2. Asymptotic extreme value distribution of the SBK estimator is investigated in Section 3, which is used to construct the SCCs of component functions. Section 4 introduces a BIC criterion in the GAM setting and provides results on consistent component selection as well as the implementation, followed by the Monte Carlo simulations in Section 5. Section 6 illustrates the application of our SCC and BIC methods to predict default of nearly 3, 500 listed companies in Japan. Technical assumptions and proofs are presented in the Appendix.

2 SPLINE-BACKFITTED KERNEL SMOOTHING IN GAM

In this section we briefly describe the SBK estimator for GAM (1) and its oracle properties obtained in

LYH. Let {Xi, Yi}ni=1 be i.i.d. observations following model (1). Without loss of generality, one denotes

x

1

=

(x2,

...,

xd)

and

m

1

(x

1)

=

c

+

d
=2

m

(x)

and

estimates

m1

(x1).

As a benchmark of efficiency, we introduce the "oracle smoother" by treating the constant c and the

last d - 1 components {m (x)}d=2 as known. The only unknown component m1 (x1) is estimated by

maximizing a local log-likelihood function l (a, x1) for each x1  [h, 1 - h]:

l

(a,

x1)

=

n-1

n
i=1

[Yi

{a

+

m

1

(Xi,

1)}

-

b

{a

+

m

1

(Xi,

1)}]

Kh

(Xi1

-

x1)

,

(3)

where a  A, a set whose interior contains m1 ([0, 1]). The oracle smoother of m1 (x1) is

mK,1 (x1) = argmax l (a, x1) .
aA

(4)

Although mK,1 (x1) is not a statistic since c and {m (x)}d=2 are actually unknown, its asymptotic

properties serve as a benchmark for estimators of m1 (x1) to achieve.

To define the SBK, we introduce the linear B spline basis for smoothing: bJ (x) = (1 - |x - J | /H)+ ,

0  J  N + 1 where 0 = 0 < 1 < · · · < N < N+1 = 1 are a sequence of equally spaced points, called

interior

knots,

on

interval

[0, 1].

Denote

by

H

=

(N

+ 1)-1

the

width

of

each

subinterval

[] J , J+1 , 0 

J  N and the degenerate knots by -1 = 0, N+2 = 1. The space of -empirically centered linear spline

7

functions on [0, 1] is

G0n,

=

{ g

:

g

(x)

=

N +1
J =0

J bJ

(x) , En

{g

(X)}

=

} 0

,

1







d,

(5)

with

empirical

expectation

En

{g

(X)}

=

n-1

n
i=1

g

(Xi).

The

space of additive

spline

functions

on

 = [0, 1]d is

Gn0

=

{ g

(x)

=

c

+

d
=1

g

(x)

;

c



R,

} g  G0n, .

(6)

The SBK method is defined in two steps. One first pre-estimates the unknown functions {m (x)}d =2 and constants c by linear spline smoothing. We define the log-likelihood function L (g) as

L

(g)

=

n-1

n
i=1

[Yig

(Xi)

-

b

{g

(Xi)}]

,

g



Gn0 .

(7)

According to Lemma 14 of Stone (1986), (7) has a unique maximizer with probability approaching 1. Therefore, the multivariate function m (x) can be estimated by an additive spline function:

m (x) = argmax L (g) .
gG0n

(8)

The spline estimator is asymptotically consistent, and can be calculated efficiently. However, no measure of
confidence can be assigned to the spline estimator, see Wang and Yang (2007) and LYH. To overcome this
problem, we adapt the SBK estimator, which combines the strength of kernel smoothing with regression spline. One then rewrites m (x) = c^+d=1 m (Xi) for c  R and m (x)  Gn0, and defines a univariate quasi-likelihood function similar to l (a, x1) in (3) as

l

(a,

x1)

=

n-1

n
i=1

[Yi

{a

+

m

1

(Xi,

1)}

-

b

{a

+

m

1

(Xi,

1)}]

Kh

(Xi1

-

x1)

,

(9)

with

m

1

(x

1)

=

c

+

d
=2

m

(x)

being

the

pilot

spline

estimator

of

m 1 (x 1).

Consequently,

the

SBK

estimator of m1 (x1) is

mSBK,1 (x1) = argmax l (a, x1) .
aA

(10)

We now introduce some useful results and definitions from LYH, under Assumptions (A1)-(A7) in appendix,

as n  ,

() sup |mSBK,1 (x1) - mK,1 (x1)| = Oa.s. n-1/2 log n ,
x1[0,1]

(11)

8

mK,1

(x1)

-

m1

(x1)

=

bias1

(x1)

h2/D1

(x1)

+

n-1

n
i=1

Kh

(Xi1

-

x1)



(Xi)

i/D1

(x1)

+

rK,1

(x1)

(12)

in which the higher order remainder rK,1 (x1) satisfies

() sup |rK,1 (x1)| = Oa.s. n-1/2h1/2 log n .
x1[h,1-h]

(13)

The scale function D1 (x1) and bias function bias1 (x1) are defined in LYH as:

b2 (x1) = E [b {m (X)} |X1

] = x1 ,

2

(x1)

=

E

{2

(X)

|X1

=

} x1

(14)

D1 (x1) = f1 (x1) 2b (x1) , v12 (x1) = K22 f1 (x1) 2 (x1) .

(15)

bias1 (x1) = µ2 (K) ×

{ m1

(x1)

D1

(x1)

+

m1

(x1)

f

(x1) b2

(x1)

-

{m1

(x1)}2

f

(x1) E [b

{m

(X)} |X1

=

]} x1

(16)

where K22 =  K2 (u) du, µ2 (K) =  K (u) u2du. The above equations (11), (12) and (13) lead one to a simplifying decomposition of the estimation error mSBK,1 (x1) - m1 (x1)

sup
x1[h,1-h]

mSBK,1

(x1)

-

m1

(x1)

-

n-1

n
i=1

Kh

(Xi1

-

x1)



(Xi)

i/D1

(x1)

()

= Oa.s. n-1/2h1/2 log n + n-1/2 log n + h2 .

(17)

A decomposition such as (17) has not appeared in the literature for any other estimators of m1 (x1), and it is fundamental for constructing SCCs in section 3.

3 GAM INFERENCE VIA SCC
In this section, we propose SCCs for GAM components.

3.1 Main Results

Denote

ah

=

 -2 log h, C

(K )

=

K  22

K-2 2

and

for

any





(0, 1),

the

quantile

Qh()

=

ah

+

ah-1

[ log

{ C

(K )/

} (2)

-

log

{ -

log

 1

-

} 

] .

(18)

9

Also with D1 (x1) and v12 (x1) given in (15), we define n (x1) = n-1/2h-1/2v1 (x1) D1-1 (x1) .

(19)

Theorem 1 Under Assumptions (A1)-(A7), as n  

{}

lim P
n

supx1[h,1-h] |mSBK,1 (x1) - m1 (x1)| /n (x1)  Qh ()

= 1 - .

A 100 (1 - ) % simultaneous confidence corridor for m1 (x1),

mSBK,1 (x1) ± n (x1) Qh () .

(20)

The above SCC for component function m1 (x1) resembles the SCCs in Bickel and Rosenblatt (1973) and H¨ardle (1989) for estimating unknown univariate nonparametric function, although it is for high dimensional nonparametric regression.

3.2 Implementation

To construct the SCC for m1 (x1) in (20), one needs to select the bandwidth h first, and then evaluate

mSBK,1 (x1) , Qh () and n (x1) given in (10), (18) and (19).

Assumption (A6) requires that the bandwidth for SCC be slightly smaller than the mean square optimal bandwidth hopt (minimizing AMISE) in LYH, we therefore have taken h = hopt(log n)-1/4 as a data-driven

undersmoothing bandwidth for SCC construction to fulfill Assumption (A6). Recent articles on SCC

for time series, such as Wu and Zhao (2007), Zhao and Wu (2008), have used similar undersmoothing

bandwidths.

For a given  and a chosen bandwidth h, one can easily estimate mSBK,1 (x1) and Qh () as in (10),

(18). To evaluate n (x1), one needs to estimate v1 (x1) and D1-1 (x1) given in (15), i.e., estimating

f (x1) , b2 (x1) and 2 (x1). The estimation of the density function f (x1) is trivial, namely, f (x1) =

n-1

n
i=1

Kh

(Xi1

-

x1).

We

further

illustrate

the

spline

estimates

of

2b (x1)

and

2 (x1)

below:

One partitions mini Xi1 = t1,0 < · · · < t1,N+1 = maxi Xi1 where N is the number of spline interior

knots,

i.e.,

N

=

Nn

=

min

([n1/4

log

] n

+

1,

[n/4d

-

1/d]

-

) 1

which

satisfies

the

assumption

(A7)

in

the

Appendix.

Then

b2 (x1)

can

be

estimated

as

3
k=0

ak1,k

x1k

+

N +3
k=4

a1,k

(x1

-

t,k-3)3

where

{a1,k }Nk=+03

10

minimize

n

[ b

{m

(Xi)}

-

{3
k=0

a1,k Xik1

+

N +3
k=4

a1,k

(Xi1

-

}]2 tk-3)3

,

i=1

and

2

(x1)

can

be

estimated

as

3
k=0

ak1,k x1k

+

N +3
k=4

a1,k

(x1

-

t,k-3)3

where

{a1,k }kN=+03

minimize

(21)

n

[ [ Yi

-

b

{m

(Xi)}]2

-

{3

a,k Xik1

+

N+3

a,k

(Xi1

-

}]2 tk-3)3

.

i=1

k=0

k=4

(22)

The resulted estimate ^n (x1) of n (x1), using (21) and (22) satisfies supx1[h,1-h] |^n (x1) - n (x1)| =
Op (n-) for some  > 0, see LYH Section 5 for details. This consistency and Slutzky's theorem ensure {}
that P supx1[h,1-h] |mSBK,1 (x1) - m1 (x1)| /^n (x1)  Qh ()  1 -  as n  , and therefore

mSBK,1 (x1) ± ^n (x1) Qh ()

(23)

is a 100 (1 - ) % simultaneous confidence corridor for m1 (x1). The SCC constructions of other components m2 (x2) , ..., md (xd) are similar. It is worthwhile to emphasize that, in general, the estimators mSBK,1 (x1) , Qh () , f (x1) and ^n (x1) remain stable if h slightly varies.

4 VARIABLE SELECTION IN GAM
In this section, we propose a Bayesian Information Criterion (BIC) for component function selection based on spline smoothing for GAM and an efficient implementation follows.

4.1 Main Results

According to Stone (1985), p.693, the space of -centered square integrable functions on [0, 1] is defined as

H0

=

{ g

:

E

{g

(X)}

=

0,

E

{g2

} (X)

<

,

1







} d

,

(24)

and the model space M is

M

=

{ g

(x)

=

c

+

d
=1

g

(x)

;

g



H0,

1







} d

,

where c is a finite constant.

(25)

11

To introduce the proposed BIC, let {1, . . . , d} denote the complete set of indices of d tuning variables (X1, ..., Xd) . For each subset S  {1, . . . , d}, define a corresponding model space MS for S as

{

}

MS = g (x) = c + S g (x) ; c  R, g  H0,   S ,

(26)

with H0 given in (24), and the space of the additive spline functions as

{

}

G0n,S = g (x) = c + S g (x) ; c  R, g  G0n,,   S ,

(27)

with G0n, given in (5). Define the least squares projection of function m in MS as

mS = argmin E {m (X) - g (X)}2
gMS

(28)

and define the set S0 of significant variables as the minimal set S  {1, . . . , d} such that E{m (X) - mS (X)}2 = 0, which is uniquely defined according to Lemma 1 of Huang and Yang (2004).
To identify S0, one computes for an index set S the BIC as

BICS

=

-2L (mS)

+

NS n

(log

n)3

(29)

where L (·) is given in (7), mS (x)  Gn0,S is the pilot spline estimator as in (8), NS = 1 + (N + 1) # (S) with N the number of interior knots, # (S) the cardinality of S. In practice, N = Nn can be taken as

([ ]

)

min n1/4 log n + 1, [n/4d - 1/d] - 1 ,

(30)

which satisfies the assumption (A7) in the Appendix. Our variable selection rule takes the subset S  {1, . . . , d} that minimizes BICS. ()
Theorem 2 Under Assumptions (A1)-(A5) and (A7), limn P S = S0 = 1.
According to Theorem 2, the variable selection rule based on the BIC in (29) is consistent. The nonparametric version BIC was firstly established in Huang and Yang (2004) for additive autoregression model, and adapted to additive coefficient model by Xue and Yang (2006), to single index model by Wang and Yang (2009). Our proposed BIC differs from all of the above as it is based on quasi-likelihood rather than mean squared error, which makes the technical proof of consistency much more challenging. To the
12

best of our knowledge, it is the first theoretically reliable information criterion in this setting.
4.2 Implementation
The proposed BIC is implemented without a greedy search through all possible subsets. Instead, the forward stepwise regression procedure is used with minimizing BIC as the criterion.

5 MONTE CARLO SIMULATION

This section studies the performance of the proposed procedures, reporting also the computational costs,

the consistency of selecting variables via BIC and the global coverage precision of the SCC. The data are

generated from

P(Y

=

1|X

=

x)

=

b

{ c

+

d
=1

m

} (X)

,

b

(x)

=

ex 1 + ex

(31)

with d = 10, c = 0, m3 (x) = m4 (x) = m5 (x) = sin (x) , m6 (x) = x, m7 (x) = ex - (e - e-1) and m (x) = 0 for  = 1, 2, 8, 9, 10. The set S0 is therefore S0 = {3, 4, 5, 6, 7}.
The predictors are generated by

Xi = 2 (Zi) - 1, Zi = (Zi1, ..., Zid)  N (0, ) , 1  i  n, 1    d,

(32)

where  is the standard normal c.d.f. and  = (1 - r) Id×d + r1d1Td . The parameter r (0  r < 1) controls the correlation between Zi,1    d.
In what follows, the performance of BIC and COSSO is firstly compared, followed by a computational comparison between the SBK and a kernel method in GAM, and it ends with a report on the SCC global coverage for components.

[Table 1 about here.]

[Table 2 about here.]
Table 1 shows the simulation results from 100 replications, where the outcome is defined in accuracy as correct fitting, if S = S0; overfitting, if S0  S; and underfitting, if S0 S. It is clear that the performance of BIC on selecting 5 significant variables m (X) ,  = 3, ..., 7, is quite satisfactory. The selection accuracy becomes higher as the sample size increases and the correlation decreases. The accuracy and computing
13

time of COSSO are also listed for comparison (Platform: R; PC: Intel 3.4 GHz processor and 16 GB RAM). It is obvious that the BIC significantly outperforms the COSSO in terms of both accuracy and computing time. To examine the computing advantage of BIC for large d, we extend d = 10 to 50 by using m3, ..., m7 as above and all the other component functions are 0. The BIC is vastly faster than COSSO for d = 50. All of these findings confirm what is expected according to the asymptotic theory.
The SCC global coverage for m (x) ,  = 3, ..., 7 is reported in Table 2. It turns out that the empirical coverage approaches the nominal confidence levels as n increases, and a better coverage occurs when the correlation is lower.
The above studies evidently indicate the reliability of our methodology, such as a high selection accuracy of the BIC and a desired global coverage of the SCC, which make their applications for credit rating modelling in the following section sensible.
6 APPLICATION
We now return to forecast default probabilities of the listed companies in Japan. The data provided by the Risk Management Institute, National University of Singapore include the comprehensive financial statements and the credit events (default or bankruptcy) from 2005 to 2010 of 3, 583 Japanese firms.
Berg (2007) found that the liability status was important to indicate the creditworthiness of a company, while Bernhardsen (2001) and Ryser and Denzler (2009) proposed to consider the "leverage effect" expressed by the financial statement ratios. Therefore, we have pooled two situations by considering X1: Current liability, X2: Current stock return, X3: Long term borrow, X4: Short term borrow, X5: Total asset, X6: Non-current liability, X7: 3 months earlier (stock) return, X8: 6 months earlier (stock) return, X9: Current ratio, X10: Net liability to shareholder equity, X11: Shareholder equity to total liability and equity, X12: TCE ratio, X13: Total debt to total asset, X14: Quick ratio.
Selecting the rating factors via the BIC given in (29), we have found that X1: Current liabilities, X7: 3 months earlier return, X8: 6 months earlier return are selected. Similar rating covariates were also discovered in Shina and Moore (2003), Berg (2007) and Ryser and Denzler (2009). However, Berg (2007) selected 23 variables which led to a non-parsimonious GAM. In contrast, Ryser and Denzler (2009) had found that 3 financial ratios (capital turnover, long-term debt ratio, return on total capital) were significant based on the blockwise cross-validation (CV) method which is nonetheless extremely time consuming in comparison to the proposed BIC.
14

Figure 1 (a)-(c) depicts the SBK estimator of the factor's default impact curve on domain, while a shoal of 95% CIs and the 95% SCC present respectively the pointwise and global uncertainty of the whole curve. The SBK estimators indicate overall monotonicities of each rating factors, and the SCCs turn out to be fairly narrow to warrant the global nonlinearities of the factors' curves which reveal the underlying nonlinear features in different segments of domain.
As for the model evaluations, the Cumulative Accuracy Profile (CAP) is used. For any credit scoring method S, one defines its alarm rate F (s) = P (S  s) and the hit rate FD (s) = P (S  s |D ) where D represents the conditioning event of "default". One then defines the CAP curve for S as

CAP

(u)

=

FD

{ F

-1

} (u)

,

u



(0,

1)

,

(33)

which is the percentage of default-infected obligators that are found among the first (according to their

scores) 100u% of all obligators. The perfect scoring method P assigns low scores first to all default-infected

obligators and thus CAPP (u) = min (u/p, 1) , u  (0, 1) where p is the unconditional default probability, whereas the completely noninformative scoring method with zero discriminatory power displays a diagonal

line CAPN (u)  u, u  (0, 1), see details of the CAP in Engelmann, Hayden and Tasche (2003).

A satisfactory scoring method's CAP curve would be expected to approach CAPP (u) and always better

than the noinformative CAPN (u), and one uses the Accuracy Ratio (AR) to quantify its position. The

AR is the ratio of the area aR enclosed between the given CAP curve and the noninformative diagonal

curve CAPN (u)  u, and the total area aP enclosed between the perfect CAP curve CAPP (u) and the

noninformative diagonal curve CAPN (u). Thus

AR

=

aR aP

=

2

1
0

CAP (u) 1-p

du

-

1

,

where CAP (u) is given in (33). The AR takes value in [0, 1], with value 0 corresponding to the noninformative scoring, and 1 the perfect scoring method, a higher AR indicates an overall higher discriminatory power of a method.
We have applied both GAM and GLM to the first 2000 companies and computed default probabilities of the remaining 1583 companies, and used the default probabilities as scores. Figure 1 (d) depicts the CAPs of GAM (thick solid) and GLM (thin solid), as well as the CAPP (u) (dashed) and CAPN (u) (dotted). Visually it is clear that GAM has much higher accuracy ratio than GLM, which is in fact the case: the AR is 97.56% for GAM, much higher than the 89.76% for GLM. Nonetheless, we failed to apply the COSSO

15

for the same data.

APPENDIX

In x

what = (x1

follows, we , x2, ..., xd)T

takeRd,·xand=·( da=s1txh2e)E1/u2claidnedanxand

supremum norms, = max1d |x|.

respectively, i.e., for any For any interval [a, b],

denote

the

space

of

p-th

order

smooth

function

by

C (p) [a,

b]

=

{ g

g(p)



C

[a,

} b] ,

and

the

class

of

Lipschitz

continuous functions by Lip ([a, b] , C) = {g ||g (x) - g (x)|  C |x - x| , x, x  [a, b] } for constant C > 0.

Lastly, define the following latent regression errors

i = Yi - b {m (Xi)} =  (Xi) i, 1  i  n.

(A.1)

We need the following technical assumptions:

(A1) The additive component functions m  C(1) [0, 1] , 1    d: m1  C(2) [0, 1] , m  Lip ([0, 1] , Cm) , 2    d for some constant Cm > 0.

(A2) The inverse link function b satisfies that b  C2 (R) , b () > 0,   R. For a compact interval  ()
whose interior contains m [0, 1]d , Cb > max b ()  min b () > cb for constants 0 < cb < Cb < .

(A3)

The conditional

variance function (

2 (x) is continuous )

and

positive

for

x  [0, 1]d.

The errors

{i}in=1

satisfy that E (i |Xi ) = 0, E |i|2+  C for some   (1/2, 1].

(A4) The joint density f (x) of (X1, ..., Xd) is continuous: 0 < cf  infx[0,1]d f (x)  supx[0,1]d f (x)  Cf < . The marginal density function f (x) of X have continuous derivatives on [0, 1] and the

uniform bounds Cf and cf . There exists a -finite measure  on R such that the distribution of Yi conditional on Xi has a probability density function fY |X (y; b {m (x)}) relative to  whose support for y is a common , and is uniformly continuous in x  [0, 1]d for y  .

(A5)

{ Zi

=

(XTi , i)}ni=1

are

independent

and

identically

distributed.

(A6) The kernel function K (x) is a symmetric probability density function supported on [-1, 1] and 

C1[-1, 1].

The

bandwidth

h = hn

satisfies

that

h = O{n-1/5(log n)-1/5} , h-1

{} = O n1/5 (log n)

for some constant  > 1/5.

16

(A7) The number of interior knots N satisfies that cN n1/4 log n  N  CN n1/4 log n for some constants cN ,CN > 0.
Assumptions (A1)-(A7) are standard in GAM, see Stone (1986), Xue and Liang (2010). Assumptions (A5), (A6) are more restrictive than in LYH for the purpose of constructing SCCs, but are unnecessary for Theorem 2 on the consistency of BIC.

A.1. Preliminaries

Throughout this section, C denotes some generic positive constant unless stated otherwise. Define

1 Mh (t) = h-1/2 K {(x - t) /h} dW (x)
0

(A.2)

where W (x) is a Wiener process defined on (0, ) and denote

dh

=

(-2

log

h)1/2

+

(-2

log

h)-1/2

{ C

(K )/

} (2)

(A.3)

with C (K) given in (18).

Lemma A.1 Under Assumption (A6). for any x  R

[{

}]

lim P (-2 log h)1/2
n

supt[h,1-h] |Mh (t)| / K22 - dh

< x = e-2e-x .

Proof. One simply applies the same steps in proving Lemma 2.2 of H¨ardle (1989). Denote by Ti the random variable b {m (Xi)}, and the Lebesgue measure on Rd as µ(d). By Assumption (A4), Xi has pdf wrt the Lebesgue measure µ(d), and Assumptions (A1) and (A2) ensure that functions b and m are at least C1, thus the random vector (Ti, Xi1) has a joint pdf wrt the Lebesgue measure µ(2), which one denotes as fT,X1 (t, x1).
Lemma A.2 Under Assumptions (A1)-(A5), for i in (A.1), the distribution of (i, Xi1) has joint pdf wrt 
µ(2) as f,X1 (z, x1) =  fY |X (y; y - z) fT,X1 (y - z, x1) d (y).
Proof. The joint pdf of (Yi, Ti, Xi1) wrt  × µ(2) is therefore fY |X (y; t) fT,X1 (t, x1). For any (z, x1)  R × [0, 1], and z, x1 > 0, one has

P [(i, Xi1)  (z - z, z + z) × (x1 - x1, x1 + x1)] = 17

P [(Yi - Ti, Xi1)  (z - z, z + z) × (x1 - x1, x1 + x1)] =





= d (y)

d

fY |X (y;  ) fT,X1 ( , 1) d1.



y- (z-z,z+z)

1(x1-x1,x1+x1)

Applying dominated convergence theorem, one has as max (z, x1)  0

{ }

P [(i, Xi1)  (z - z, z + z) × (x1 - x1, x1 + x1)] -

fY |X (y; y - z) fT,X1 (y - z, x1) d (y)



×µ(2) [(z - z, z + z) × {(x1 - x1, x1 + x1)  [0, 1]}] = O(1)

hence

the

the

joint

pdf

of

(i, Xi1)

wrt

µ(2)

is

  fY |X

(y; y

-

z) fT,X1

(y

-

z, x1) d (y).

 For theoretical analysis, we write cJ, = E bJ (X) = bJ (x) f (x) dx and define the centered B

spline basis bJ, (x) and the standardized B spline basis BJ, (x) respectively as

bJ, (x)

=

bJ

(x)

-

cJ, cJ -1,

bJ

-1

(x)

,

BJ, (x) = {

bJ, (x)

}1/2 , 1  J  N + 1,

bJ2, (x) f (x) dx

(A.4)

so that E BJ, (X)  0, E BJ2, (X)  1. One can rewrite with slight abuse of notations the log-likelihood L (g) given in (7) as

L

(g)

=

L

()

=

n-1

n
i=1

[ YiTB

(Xi)

-

b

{ TB

}] (Xi)

,

(A.5)

with g (Xi) = TB (Xi)  Gn0 ,  = (0, J,)1TJN+1,1d  RNd with Nd = (N + 1) d + 1, B (x) = {1, B1,1 (x1) , ..., BN+1,d (xd)}T and BJ, (x) as given in (A.4). It is straightforward to verify that the
gradient and Hessian of L () are

L^ () = 2L^ ()

=n--1n-1ni=1 [nYiBb({Xi)T-B
i=1

{ }] b TB (Xi) B (Xi)
} (Xi) B (Xi) B (Xi)T .

,

(A.6)

Proposition A.1 Under Assumptions (A1)-(A5) and (A7), for m  M with M given in (25) and m as in

(8),

as

n



,

m

-

m2,n

+ m

-

m2

=

Oa.s.

( N

1/2n-1/2

log

) n

and

m

-

m

=

Oa.s.

( N

n-1/2

log

) n.

With probability approaching 1, the Hessian matrix 2L^ () satisfies that 2L^ () < 0,  and 2L^ () 

-cbcV I if TB (Xi)  , 1  i  n.

18

Proof. See Lemma A.13 of LYH, Assumption (A2), equation (A.6) and Lemma A.11 of LYH.

A.2. Proof of Theorem 1

Proof.

Define

a

stochastic

process

n (x1)

=

n-1

n
i=1

Kh

(Xi1

-

x1)

i, x1



[0, 1]

with

i

given

in

(A.1),

then (12) and (13) show that

() supx1[h,1-h] mK,1 (x1) - m1 (x1) - D1-1 (x1) n (x1) = Oa.s. h2 + n-1/2h1/2 log n ,

which, together with (11), lead to

supx1[h,1-h] mSBK,1 (x1) - m1 (x1) - D1-1 (x1) n (x1)

(

)(

)

= Oa.s. h2 + n-1/2h1/2 log n + n-1/2 log n = Oa.s. h2 + n-1/2 log n .

(A.7)

Using v1 (x1) given in (15), one can standardize n (x1) and then replace x1 by t to obtain

n

(t)

=

(nh)1/2

v1-1

(t)

n

(t)

=

(nh)1/2

v1-1

(t)

{ n-1

n
i=1

Kh

(Xi1

-

t)

} i

.

(A.8)

Assumptions (A5), (A8) imply that the following Rosenblatt transformation to the 2-dimensional sequence {X1i, i}ni=1 produces {Xi1, i }in=1 with (Xi1, i ) uniformly distributed on [0, 1]2:

(Xi1,

i )

=

T

(X1i,

i)

=

{ FX1

(X1i)

,

F|X1

} (i|X1i)

.

Denote

Zn

(x1,

)

=

 n

{Fn

(x1,

)

-

F

(x1,

)}

where

Fn

(x1,

)

is

the

empirical

distribution

of

{Xi1,

i}ni=1,

one can rewrite n (t) as



n (t) = h-1/2v1-1 (t)

K {(x1 - t) /h} dZn (x1, ) .

By the strong approximation theorem in Tusnady (1977), there exists a version of the 2-dimensional Brownian Bridge Bn (x1, ) such that

()

sup |Zn (x1, ) - Bn {T (x1, )}| = Oa.s.

n-1/2

2
log

n

.

x1,s

(A.9)

19

Applying standard techniques used in Bickel and Rosenblatt (1973), H¨ardle (1989), one can show that

{} sup n (t) - Mh (t) / K22 = Op (log n)-1/2 ,
t[0,1]

(A.10)

for a version of the Mh (t) given in (A.2). Similar result can be found in Xia (1998). Furthermore, (A.7) and (A.8) imply that
() supx1[h,1-h] -n 1 (x1) {mSBK,1 (x1) - m1 (x1)} - n (x1) = Oa.s. n1/2h5/2 + h1/2 log n ,

(A.11)

with n (x) given in (19). Under Assumption (A6), which entails that (-2 log h)1/2 is of the same order as (log n)1/2, (A.10) and (A.11) can show that

supx1[h,1-h] (-2 log h)1/2 n-1 (x1) |mSBK,1 (x1) - m1 (x1)| - |Mh (t)| / K22

{(

)}

= Oa.s (log n)1/2 × n1/2h5/2 + h1/2 log n + Op (1) = Op (1) .

(A.12)

Finally, Theorem 1 follows from Lemma A.1 and Slutsky's Theorem.

A.3. Proof of Theorem 2

Prior to proving Theorem 2, we restate Proposition A.1 for any index set S  {1, 2, . . . d}. Denote by  = (0, J,)T1JN+1,1d an arbitrary vector. For any S, NS = 1 + (N + 1) # (S), denote

S = (0, J,)T1JN+1,S  RNS , BS (x) = {1, BJ, (x)}1TJN+1,S ,

(A.13)

and with slight abuse of notations

LS

(S )

=

LS

{ TS BS

} (x)

=

n-1

n
i=1

[ YiSTBS

(Xi)

-

b

{ STBS

}] (Xi)

(A.14)

T
whose maximizer is mS = S BS (x).

Proposition A.2 Under Assumptions (A1)-(A5) and (A7), for mS  MS given in (28), mS in (A.14), as

n



,

mS

-

mS 2,n

+ mS

-

mS 2

=

Oa.s.

( N

1/2n-1/2

log

) n

and

mS

-

mS 

=

Oa.s.

( N

n-1/2

log

) n.

Next, we consider two cases "underfitting" and "overfitting" for the index set S to establish Theorem 2.

20

Definition: if S  S0 and S = S0, then S overfits, while S is underfitting if S0 S = S0 with S0 given

in Theorem 2. We shall show that limn P (BICS - BICS0 > 0) = 1 in both situations.

Proof. I: overfitting, i.e., S  S0 and S = S0.

Let

S0S

=

{ S0

,

( J,

)T
1J

N

+1,

S

\S0

} ,

S0S

=

{ S0

,

( J,

)T 1(J

N)+1,

S\S(0

}

with )

J,



0

and

S

( or S0) as the MLE of (A.14) (or when S = S0). Note that LS S0S = LS0 S0 .

Using Taylor's expansion,  a vector S between S and S0S, i.e., S = tS + (INs - t) S0S with a

Ns × Ns diagonal matrix t whose diagonal elements are in [0, 1] s.t.

()

()

()

()

LS0 S0 - LS S = LS S0S - LS S

=

( S0S

-

)T S



LS

() S

+

1 2

( S0S

-

)T S

2

LS

() S

( S0S

-

) S

.

Since

LS

() S

=

0

and

2LS

() S

is

given

in

(A.6),

for

mS

=

T
S BS

(x),

one

has

(A.15)

()

()

LS0 S0 - LS S

=

-

(2n)-1

n
i=1

b

{T S BS

} (Xi)

{( S0S

-

)T S

BS

} (Xi)

{( S0S

-

)T S

BS

}T (Xi)

=

-

(2n)-1

n
i=1

b

{mS

(Xi)}

{mS0

(Xi)

-

mS

(Xi)}2

.

(A.16)

By

m

=

mS0

=

mS



MS0



MS ,

Proposition

A.2

implies

that

mS0

-

m2,n

=

Oa.s.

( N

1/2n-1/2

log

) n

and

mS

-

m2,n

=

Oa.s.

( N

1/2n-1/2

log

) n,

thus

mS0

-

mS 22,n

=

Oa.s.

( N

n-1log2n)

.

(A.17)

Similarily, one has mS - m = oa.s. (1), which warrants for large n that mS   with  given in Assumption (A.2), so (A.16) implies that

0



LS0

() S0

-

LS

() S



- Cb 2

mS0

-

mS 22,n

.

(A.18)

As a result, BIC given in (29) shows that

BICS

- BICS0

=

{ 2 LS0

() S0

-

LS

( )} S

+

NS

- NS0 n

log3n

 -Cb mS0 - mS22,n + (N + 1) n-1log3n,

(A.19)

21

which implies by (A.17) that limn P (BICS - BICS0 > 0) = 1. II: underfitting, i.e., S0 S = S0. Let S = S0  S and denote by S0, S and S the MLEs in (A.14) for S0, S and S, respectively. Since S overfits S0, similarly to (A.18), one has

0



LS0

() S0

-

LS

() S



- Cb 2

mS0

-

mS 22,n

,

(A.20)

Define

a

set

S

=

{ S

:

TS BS

(Xi)



, 1



i



} n.

which is compact and convex in RNS .

By

definition,

max
1in

T
S

BS

(Xi)

-

m

(Xi)

()  mS - m = Oa.s. N n-1/2 log n ,

so for large n, with probability approaching 1, S  S, so Proposition A.1 ensures that, with probability

()

()

approaching 1, the Hessian matrix 2LS S  -cbcV INS , while LS S = 0 and 2LS (S)  0,

 S. Thus, with probability approaching 1, there exists a constant c1 > 0 such that

 ( ) 

2
-2-1cbcV S - S ,

LS (S ) - LS S  

() max LS (S) - LS S  -c1,

S S

if S  S .
otherwise

(A.21)

Next,

define

a

new

vector

SS

=

{ S

,

( J,

)T
1J

N

+1,

S\S

}

with

J,



0

and

note

that

T
SS

BS (x)



T
mS (x) , S

BS (x)



mS (x),

so

applying

Lemma

A.5

of

Wang

and

Yang

(2007),

there

exists

a constant C0 > 0 such that

SS - S 2  C0-1 mS - mS 22 .

Applying Proposition A.2 entails that

()

mS - mS 22 - mS - mS 22 = Oa.s.

N

n-1

2
log

n

while the definitions of underfitting and overfitting lead to

mS - mS 22 = mS - m22 = cS > 0

and thus

SS - S

2



C0-1cS

+

Oa.s.

( N

n-1

log2n)

.

(A.22)

22

Note next that

()

()

()

()

LS S - LS S = LS SS - LS S

which according to (A.21), is bounded by

 

-2-1cbcV

2
SS - S ,

 

()

max
S S

LS

(S )

-

LS

S



-c1,

if SS  S otherwise

which is, according to (A.22), bounded by



max

(-2-1

cbcV

C0-1cS

,

) -c1

+

Oa.s.

( N

n-1log2n)

=

-c2

+

Oa.s.

( N

n-1log2

) n

,

for

a

constant

c2

> 0.

()

()

The above bound, together with (A.17), (A.20) and (A.23) lead to LS0 S0 - LS S

{ ()

( )} { ( )

( )}

= LS0 S0 - LS S - LS S - LS S



c2

+

Oa.s.

( N

n-1log2n)

.

(A.23) (A.24)

Finally, (A.24) implies that

BICS

- BICS0

=

{ 2 LS0

() S0

-

LS

( )} S

+

NS

- NS0 log3n n



c2

+

Op(1) ,

and thus limn P (BICS - BICS0 > 0) = 1.

(A.25)

References
[1] Berg, D. (2007), "Bankruptcy Prediction by Generalized Additive Models," Applied Stochastic Models in Business and Industry, 23, 129­143.
[2] Bernhardsen, E. (2001), A Model of Bankruptcy Prediction, Norges Bank WP, 2001. [3] Bickel, P.J. and Rosenblatt, M. (1973), "On Some Global Measures of the Deviations of Density
Function Estimates," Annals of Statistics, 1, 1071­1095. [4] Engelmann, B., Hayden, E. and D. Tasche. (2003), "Testing Rating Accuracy," Risk, 16, 82­86.

23

[5] Fan, J., H¨ardle, W. and Mammen, E. (1998). Direct estimation of low-dimensional components in additive models. Ann. Statist. 26, 943­971.
[6] Fan, J. and Zhang, W. Y. (2000), "Simultaneous Confidence Bands and Hypothesis Testing in Varyingcoefficient Models," Scandinavian Journal of Statistics, 27, 715­731.
[7] H¨ardle, W. (1989). Asymptotic maximal deviation of M-smoothers. Journal of Multivariate Analysis 29, 163­179.
[8] H¨ardle, W., Hoffmann, L. and Moro, R. (2011), Learning Machines Supporting Bankruptcy prediction. Statistical Tools in Finance and Insurance (2nd ed.), Cizek, H¨ardle, Weron, Springer Verlag.
[9] Hastie, T. J. and Tibshirani, R. J. (1990), Generalized Additive Models, Chapman and Hall, London. [10] He, X., Fung, W. and Zhu, Z. (2005), "Robust Estimation in Generalized Partial Linear Models for
Clustered Data," Journal of the American Statistical Association, 100, 1176­1184. [11] He, X., Zhu, Z and Fung, W. (2002), "Estimation in A Semiparamtric Model for Longitudinal Data
with Unspecified Dependence Structure," Biometrika, 89, 579­590. [12] Horowitz, J. and Mammen, E. (2004), "Nonparametric Estimation of An Additive Model with A Link
Function," Annals of Statistics, 32, 2412­2443. [13] Horowitz, J., Klemel¨a, J. and Mammen, E. (2006), "Optimal Estimation in Additive Regression,"
Bernoulli, 12, 271­298. [14] Huang, J. Z. and Yang, L. (2004), "Identification of Nonlinear Additive Autoregression Models,"
Journal of the Royal Statistical Society: Series B, 66, 463­477. [15] Linton, O. B. (1997), "Efficient Estimation of Additive Nonparametric Regression Models," Biometri-
ka, 84, 469­473. [16] Linton, O. B. and H¨ardle, W. (1996), "Estimation of Additive Regression Models with Known Links,"
Biometrika, 83, 529­540. [17] Liu, R. and Yang, L. (2010), "Spline-backfitted Kernel Smoothing of Additive Coefficient Model,"
Econometric Theory, 26, 29­59.
24

[18] Liu, R., Yang, L and H¨ardle, W. (2013), "Oracally Efficient Two-Step Estimation of Generalized Additive Model," Journal of the American Statistical Association, 108, 619­631.
[19] Ma, S. and Yang, L. (2011), "Spline-backfitted Kernel Smoothing of Partially Linear Additive model," Journal of Statistical Planning and Inference, 141, 204­219.
[20] Ma, S., Yang, L. and Carroll, R. J. (2012), " Simultaneous Confidence Band for Sparse Longitudinal Regression," Statistica Sinica, 22, 95­122.
[21] Ryser, M. and Denzler, S. (2009), "Selecting Credit Rating Models: A Cross-validation-based Comparison of Discriminatory Power," Financ Mark Portf Manag, 23, 187­203.
[22] Shina, Y. and Moore, W. (2003), "Explaining Credit Rating Differences between Japanese and U.S. Agencies," Review of Financial Economics, 12, 327­344.
[23] Song, Q. and Yang, L. (2010), "Oracally Efficient Spline Smoothing of Nonlinear Additive Autoregression Model with Simultaneous Confidence Band," Journal of Multivariate Analysis, 101, 2008­2025.
[24] Stone, C. J. (1985), "Additive Regression and Other Nonparametric Models," Annals of Statistics, 13, 689­705.
[25] Stone, C. J. (1986), "The Dimensionality Reduction Principle for Generalized Additive Models," Annals of Statistics, 14, 590­606
[26] Tusnady, G. (1977), "A Remark on the Approximation of the Sample Distribution Function in the Multidimensional Case," Period. Math. Hungar., 8, 53­55.
[27] Wang, L. and Yang, L. (2007), "Spline-backfitted Kernel Smoothing of Nonlinear Additive Autoregression Model," Annals of Statistics, 35, 2474­2503.
[28] Wang, L., Li, H., and Huang, J. (2008), "Variable Selection in Nonparametric Varying-coefficient Models for Analysis of Repeated Measurements," Journal of the American Statistical Association, 103, 1556­1569.
[29] Wu, W. and Zhao, Z. (2007), "Inference of Trends in Time Series," Journal of the Royal Statistical Society: Series B, 69, 391­410.
[30] Xia, Y. (1998), "Bias-corrected Confidence Bands in Nonparametric Regression," Journal of the Royal Statistical Society: Series B, 60, 797­811.
25

[31] Xue, L. and Liang, H. (2010), "Polynomial Spline Estimation for A Generalized Additive Coefficient Model," Scandinavian Journal of Statistics, 37, 26­46.
[32] Xue, L. and Yang, L. (2006), "Additive Coefficient Modeling via Polynomial Spline," Statistica Sinica, 16, 1423­1446.
[33] Yang, L., Sperlich, S. and H¨ardle, W. (2003), "Derivative Estimation and Testing in Generalized Additive Models," Journal of Statistical Planning and Inference, 115, 521­542.
[34] Zhang, H. and Lin, Y. (2006), "Component Selection and Smoothing for Nonparametric Regression in Exponential Families," Statistica Sinica, 16, 1021­1042.
[35] Zhao, Z. and Wu, W. (2008), "Confidence Bands in Nonparametric Time Series Regression," Annals of Statistics, 36, 1854­1878.
26

Figure 1: Plots of the rating factors in (a)-(c): SBK estimators (thin), 95% CIs (dashed) and 95% SCCs (thick). Plot of the CAPs in (d): Perfect (dashed), GAM (thick solid), GLM(thin solid), noninformative(dotted).

Confidence Level = 0.95

Confidence Level = 0.95

10 15 20

10 15

m(x) 05

m(x) -10 -5 0 5

-10 -5

0 0.5 x
(a) Current Liability

1

Confidence Level = 0.95

0 0.5 1 x
(b) 3 Months Earlier Return
Cumulative Accuracy Profile

Default 0 0.5 1

10 15 20

m(x) 05

-10 -5

0 0.5 1 x
(c) 6 Months Earlier Return

0
27

0.5 Population

1

(d) The CAP Curves

Computing Time

Accuracy

d r n BIC COSSO Ratio BIC

COSSO

250 0.43

5.90 13.7 4 90 6 20 66 14

0 500 0.58 11.50 19.8 0 95 5 7 85 8

1000 1.05 27.89 26.6 0 99 1 6 90 4

10

250 0.51

6.12 12.0 31 62 7 42 44 14

0.5 500 0.64 12.90 20.1 3 91 6 17 73 10

1000 1.12 29.43 26.3 0 99 1 12 82 6

250 1.89

- - 87 10 3 - - -

0 500 2.76 209.34 76 14 77 9 21 46 33

1000 5.14 531.96 103 0 96 4 1 89 10

50

250 2.02

- - 90 4 6 - - -

0.5 500 2.87 215.64 75 63 32 5 44 26 30

1000 5.39 545.43 101 10 86 4 10 71 19

Table 1: Simulation results for the proposed BIC method and COSSO with d = 10 and 50. For each setup, the first, second, and third columns under Accuracy give respectively the frequencies of under fitting, correct fitting, and over fitting over 100 replications. Ratio is the computing time of COSSO over that of BIC. For d = 50 and n = 250, COSSO becomes unstable to the point of crashing.

28

rn



34567

0.0 250 0.925 0.920 0.920 0.930 0.925

500 0.955 0.945 0.945 0.950 0.955

1000 0.950 0.945 0.950 0.945 0.950

0.5 250 0.910 0.910 0.915 0.920 0.920

500 0.935 0.925 0.930 0.930 0.935

1000 0.945 0.945 0.940 0.950 0.945

Table 2: The 95% SCC global coverage for ma (x) ,  = 3, ..., 7 from 200 replications

29

SFB 649 Discussion Paper Series 2014
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Principal Component Analysis in an Asymmetric Norm" by Ngoc Mai Tran, Maria Osipenko and Wolfgang Karl Härdle, January 2014.
002 "A Simultaneous Confidence Corridor for Varying Coefficient Regression with Sparse Functional Data" by Lijie Gu, Li Wang, Wolfgang Karl Härdle and Lijian Yang, January 2014.
003 "An Extended Single Index Model with Missing Response at Random" by Qihua Wang, Tao Zhang, Wolfgang Karl Härdle, January 2014.
004 "Structural Vector Autoregressive Analysis in a Data Rich Environment: A Survey" by Helmut Lütkepohl, January 2014.
005 "Functional stable limit theorems for efficient spectral covolatility estimators" by Randolf Altmeyer and Markus Bibinger, January 2014.
006 "A consistent two-factor model for pricing temperature derivatives" by Andreas Groll, Brenda López-Cabrera and Thilo Meyer-Brandis, January 2014.
007 "Confidence Bands for Impulse Responses: Bonferroni versus Wald" by Helmut Lütkepohl, Anna Staszewska-Bystrova and Peter Winker, January 2014.
008 "Simultaneous Confidence Corridors and Variable Selection for Generalized Additive Models" by Shuzhuan Zheng, Rong Liu, Lijian Yang and Wolfgang Karl Härdle, January 2014.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

