BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2014-053
IMPROVED VOLATILITY ESTIMATION BASED ON
LIMIT ORDER BOOKS
Markus Bibinger* Moritz Jirak* Markus Reiss*
* Humboldt-Universit‰t zu Berlin, Germany
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universit‰t zu Berlin Spandauer Straﬂe 1, D-10178 Berlin

IMPROVED VOLATILITY ESTIMATION BASED ON LIMIT ORDER BOOKS 
By Markus Bibinger, Moritz Jirak, Markus Reiﬂ
Humboldt-Universit®at zu Berlin
For a semi-martingale Xt, which forms a stochastic boundary, a rate-optimal estimator for its quadratic variation X, X t is constructed based on observations in the vicinity of Xt. The problem is embedded in a Poisson point process framework, which reveals an interesting connection to the theory of Brownian excursion areas. A major application is the estimation of the integrated squared volatility of an efficient price process Xt from intra-day order book quotes. We derive n-1/3 as optimal convergence rate of integrated squared volatility estimation in a high-frequency framework with n observations (in mean). This considerably improves upon the classical n-1/4-rate obtained from transaction prices under microstructure noise.

1. Introduction. Consider observations (Yi) above a stochastic boundary (Xt, t  [0, 1]), which is formed by the graph of a continuous semimartingale. The objective is to optimally recover the driving characteristic X, X t of the boundary Xt, given the observations (Yi). Such (stochastic) frontier models naturally arise in many applications and a quantification of the information content in these observations is non-trivial. We formulate the problem with an emphasis on the financial context of limit order books. From a microeconomic point of view ask prices will always lie above the efficient market price. Here the underlying latent efficient log-price of a stock (Xt, t  [0, 1]), observed over a trading period like a day, serves as the boundary, whereas ask prices form the observations (Yi). Bid prices can be handled symmetrically and independently, which can be used to validate the model.
Let the continuous Ito^ semi-martingale

(1.1)

tt
Xt = X0 + as ds + s dWs , t  [0, 1],
00

Financial support from the Deutsche Forschungsgemeinschaft via SFB 649 O®konomisches Risiko and FOR 1735 Structural Inference in Statistics: Adaptation and Efficiency is gratefully acknowledged.
AMS 2000 subject classifications: Primary 60H30; secondary 60G55; JEL classes: C22, C58 Keywords and phrases: Brownian excursion area, limit order book, integrated volatility, Feynman≠Kac, high-frequency data, Poisson point process

1

2 M. BIBINGER, M. JIRAK & M. REISS

Fig 1. Left: Microstructure noise model Yi = Xi/n + i, i = 0, . . . , n = 1000, with i iid
Exp(50). Right: Poisson point process model with intensity t,y = 150n (yXt) with Xt an
Ito^ process.

be defined on a filtered probability space (, F, (Ft), P), which satisfies the

usual conditions, with W denoting a standard (Ft)-Brownian motion. Its

total quadratic variation

X, X 1 =

1 0

s2

ds

is

also

called

integrated

squared

volatility and forms a central object for risk and portfolio management. A

natural continuous-time embedding of the boundary problem is in terms of

a Poisson point process (PPP). Conditional on (Xt, t  [0, 1]) we observe a PPP on [0, 1] ◊ R with intensity measure

(1.2)

1

(A) =

1A(t, y)t,y dt dy, where t,y = n1(y  Xt).

0R

We denote by (Tj, Yj) the observations of that point process, which are homogeneously dispersed above the graph of (Xt, t  [0, 1]). Theoretically and also intuitively, information on the stochastic boundary can only be recovered from the lowest observation points and a homogeneous intensity away from the boundary is assumed for convenience only.
An associated discrete-time regression-type model, which explains well the difference to regular microstructure noise models, is defined by

(1.3)

Yi = Xtni + i , i = 0, . . . , n, i  0, i iid F ,

with observation times tin and an error distribution function F satisfying



(1.4)

F(x) = x 1 + O(1) , as x  0.

One natural parametric specification is i  Exp(). The noise is assumed to be independent of the signal part X. In microstructure noise models for transaction prices it is usually assumed that E[i] = 0 holds, while here Xtni

3

defines the boundary of the support measure for Yi, which we may interpret as best ask price at time tin. In fact, if the boundary function was piecewise
constant, then by standard PPP properties we would obtain the regression-

type model (1.3) with exponential noise from the PPP-model (1.2) by taking

local minima (on those pieces). Here we show that under so called high-

frequency asymptotics, the fundamental quantities in both models exhibit

the same asymptotic behaviour, see Proposition 3.2 below. Compare also [17]

for the stronger Le Cam ≠ equivalence in the case of smoother boundaries.

Both observation models are illustrated in Figure 1.

Mostly, we shall concentrate on the more universal PPP model which also

allows for simpler scaling and geometric interpretation. Local minima mn,k of Yj for Tj in some small interval [khn, (k + 1)hn)  [0, 1] will form the basic quantities to recover the boundary, which by PPP properties leads to

the study of


(k+1)hn



P(mn,k > x) = E exp -

(Xt + x)+ dt , x  R,

khn

where A+ = max(A, 0), and its associated moments. For the fundamental case Xt = Wt, this opens an interesting connection to the theory of Brownian excursion areas and also reveals the difficulty of this problem. It is well documented in the literature, see e.g. [16], that no explicit form of the expectation in the expression above is available. Essentially only (double) Laplace transforms and related quantities are known, cf. Proposition 3.3 below and the attached discussion. This makes the recovery of X, X 1 an intricate probabilistic question. Still, we are able to prove that our estimator attains the improved rate n-1/3, compared to regular microstructure noise models. What is more, by information-theoretic arguments we are able to derive a lower bound showing that the n-1/3-rate is indeed minimax optimal. A more direct proof seems out of reach because the Poisson part from the noise intertwines with the Gaussian martingale part in a way which renders the likelihood and respective Hellinger distances difficult to control, even asymptotically.
The growing finance literature on limit order books so far focusses on modeling and empirical studies. Empirical contributions as [4], [6] and [18] have investigated price and volume distribution, inter-event durations as well as the structure of the order-flow. Probabilistic models proposed for a limit order book include point process models, see [9], [2] and [15], with mutually exciting processes. Other models come from queuing theory, for instance [11], [24] and [10], or stochastic optimal control theory as [7]. The main objective of most modeling approaches is to explain how market prices arise from the

4 M. BIBINGER, M. JIRAK & M. REISS
Fig 2. Order price levels for Facebook asset (NASDAQ) from 12:00 to 12:30 on June 2nd 2014. Colored areas highlight spreads between different bid and ask levels from level 1 up to level 5, bid-ask spread is colored in dark red.2
book. For the financial application, this papers adopts a new course. It is the first work, to the best of our knowledge, with the focus on statistical inference for the volatility based on observations from a limit order book. We have already highlighted the relationship of the suggested model to the regular microstructure noise model which constitutes the standard setup for developing volatility estimators. Let us mention the work by [1], [27], taken up by [3] and [14], among many others, who describe high-frequency intraday trading prices as convolution of discretized observations of the efficient log-price with additive observation noise ascribed to market microstructure. The optimal convergence rate for volatility estimation in this model with Gaussian noise and n observations on an equidistant grid is n-1/4, see [13]. Recently, as information from order books become more and more available, researchers and practitioners have sparked the discussion to which kind of observed prices estimation methods should be applied. [12] discuss this point and the possibilities of mid-quotes, executed traded prices or micro-prices which are volume-weighted combinations of bid and ask order levels. None of these observed time series, however, is free from market microstructure corruptions and the idea of an underlying efficient price remains untouched. Figure 2 visualizes the information about the evolution of prices provided by a limit order book for one specific data set. The colored areas highlight differences between the five best bid and five best ask levels, the dark area in the center marking the bid-ask spread between best bid and best ask.
2Data provided by LOBSTER academic data ≠ powered by NASDAQ OMX.

5

The idea is that an efficient price must always lie below the best ask (and symmetrically above the best bid) and that its distance to this stochastic frontier is homogeneous.
The remainder of the paper is organized as follows. In Section 2 we present an estimation approach based on local order statistics whose asymptotic properties are explored in Section 3. In Section 4 we prove the lower bound for the minimax estimation rate. Section 5 concludes. Proofs are provided in the Appendix.

2. Volatility estimation based on local minima. We construct the
integrated volatility estimator in both models (1.2) and (1.3). We partition the unit interval into h-n 1  N equi-spaced bins Tkn = [khn, (k + 1)hn), k = 0, . . . , hn-1 - 1, with bin-widths hn. For simplicity suppose that nhn  N. As n   the bin-width gets smaller hn  0, whereas the number of observed values on each bin gets large, nhn  . If we think of a constant signal locally on a bin observed with one-sided positive errors, classical parametric
estimation theory motivates to use the bin-wise minimum as an estimator of
the local signal (it then forms a sufficient statistic under exponential noise
or equivalently in the PPP model). In the regression-type model (1.3) with equidistant observation times tin = i/n, we therefore set

(2.1)

mn,k

=

min
iIkn

Yi

,

Ikn

= {khnn, khnn + 1, . . . , (k + 1)hnn - 1} .

Equally, in the PPP model (1.2) the local minima are given by

(2.2)

mn,k

=

min
Tj Tkn

Yj

,

Tkn = [khn, (k + 1)hn) .

The same symbol mn,k is used in both models because the following con-

struction only depends on the mn,k. All results and proofs will refer to the

concrete model under consideration.

Since Var(mn,k | (Xt))  (nhn)-2 holds in both models, the variance is

much smaller than for an estimator based on a local mean. Nevertheless,

we may continue in the spirit of the pre-averaging paradigm, cf. [14], and

interpret mn,k as a proxy for Xt on Tkn, which in a second step is inserted in

the realized variance expression

h-n 1 i=1

(Xkhn

- X(k-1)hn )2

without

noise.

The

use of a locally constant signal approximation Xt = Xkhn + OP(hn1/2) on Tkn

is only admissible, however, if hn is chosen so small that hn1/2 = o((nhn)-1),

which would result in a sub-optimal procedure.

Rate-optimality can be attained if we balance the magnitude (nhn)-1 of bin-wise minimal errors due to noise with the range hn1/2 of the motion of

6 M. BIBINGER, M. JIRAK & M. REISS

Fig 3. The points indicate the function (2) with K = 31.6 for small (left) and moderate (right) values of 2. The calculation is based on accurate Monte Carlo simulations. The
lines show close linear functions for comparison.

X on the bin. This gives the order

(2.3)

hn



(n)-

2 3

,

nhn



n

1 3

-

2 3

.

In the PPP model (1.2) this natural choice of the bin-width also follows nicely by a scaling argument: WØ t = hn-1/2Whnt defines a standard Brownian motion for t  [0, 1] based on the values of W on [0, hn]; the correspondingly scaled PPP observations (TØj, YØj) with TØj = h-n 1Tj, YØj = hn-1/2Yj have an
intensity with density Øt,y = nhn3/21(y  WØ t), which becomes independent
of n exactly for hn = (n)-2/3.
In this balanced setup the law of the statistics mn,k depends on the motion
of X as well as the error distribution in a non-trivial way. Still, the natural
statistics to assess the quadratic variation of the boundary process X are the squared differences (mn,k - mn,k-1)2 between consecutive local minima.
In the PPP model and with the choice

(2.4)

hn

=

K

2 3

(n)-

2 3

for

some

constant

K>0

the law of h-n 1/2mn,k is independent of n, hn and  and for Xt = X(k-1)hn +



t (k-1)hn

dWs

on

Tkn-1

 Tkn,

we

may

introduce

(2.5)

  2

=

h-n 1Emn,k

-

2 mn,k-1

,

k

=

1, . .

.

,

hn-1

-

1.

Below we shall derive theoretical properties of  and in particular we shall see that it is invertible as soon as K > 0 is chosen sufficiently large. Numerically, the function  can be determined by standard Monte Carlo simulations, see Figure 3, and is thus available. This paves the way for a momentestimator approach. In fact, k(mn,2k - mn,2k-1)2 approximates (t2)dt

7

with corresponding summation and integration intervals. Under regularity assumptions on t  t2 and by the smoothness of  shown below, we have

-1

lrn-1/2

 mn,2k

-

mn,2k-1

2

2h-n 1rn

k=(l-1)rn-1/2+1

 l2rn-1hn ,

where rn-1hn is a coarse grid size with rnhn-1, rn-1  2N. This gives rise to

the following estimator of integrated volatility IV

=

1 0

t2dt

in

the

PPP

model (1.2) with bin-width (2.4):

(2.6)

IV

hn,rn n

rnh-n 1
= -1

l=1

lrn-1/2

 mn,2k

-

mn,2k-12

2hn-1

rn

k=(l-1)rn-1/2+1

hnrn-1.

In the regression-type model (1.3) the corresponding second moments still

depend on n and we write explicitly

(2.7)

 n 2

=

h-n 1Emn,k

-

2 mn,k-1

,

k

=

1, . .

.

,

hn-1

-

1.

We shall see below that n   holds, but a non-asymptotic form of the volatility estimator from regression-type observations is given by

(2.8)

IV

hn,rn n

rnh-n 1
= -n 1

l=1

lrn-1/2

 mn,2k

-

2 mn,2k-1

2hn-1

rn

k=(l-1)rn-1/2+1

hnrn-1.

For a parametric estimation of t =  = const., we employ an estimator

I

V

hn,hn n

.

This

means

inversion

of

the

whole

sum

of

squared

differences

is

conducted. In the nonparametric case of varying t instead an estimator

I

V

hn,rn n

,

with

rn



0, rn-1hn



0,

is

applied.

A

balance

between

a

second

order term on each coarse interval of order rn and an approximation error

controlled by a Lipschitz assumption on t of order rn-1hn will lead to the

choice rn  h1n/2  (n)-1/3.

3. The law of local minima and the convergence rate of the estimator. In order to centralise the local minima, we write

(3.1)

mn,k - mn,k-1 = Rn,k - Ln,k , k = 1, . . . , hn-1 - 1 ,

where Rn,k = mn,k - Xkhn and Ln,k = mn,k-1 - Xkhn measure the distances between the minima on bin Tkn and Tkn-1, respectively, to the cen-
tral true value Xkhn between both bins. In our high-frequency framework

8 M. BIBINGER, M. JIRAK & M. REISS

Fig 4. Distributions of bin-wise minima of the signal process, noise and the convolution. Based on 100000 simulated bins with  = 1, i  Exp(5), nhn = 100.

the drift is asymptotically negligible and a regular volatility function will
be approximated by a piecewise constant function on blocks of the coarse grid. In this setting, where Xt = Xkhn + (Wt - Wkhn), we may invoke time-reversibility of Brownian motion to see that Xt - Xkhn, t  Tkn-1, and Xt - Xkhn, t  Tkn, form independent Brownian motions of variance 2 such that Rn,k, Ln,k, k = (l - 1)rn-1 + 1, . . . , lrn-1, are all identically distributed and there is independence whenever different bins are considered (but Rn,k and Ln,k+1 are dependent). From (2.5) and (3.1) we infer
(k2hn )hn = E[Rn2,k] + E[L2n,k] - 2E[Rn,k]E[Ln,k] = 2 Var(Rn,k),
and similarly for n. The histogram in Figure 4 shows the distribution of Rn,k (equivalently Ln,k) in the regression model jointly with the associated histograms for miniIkn Xtin -Xkhn and miniIkn i. In this situation the law of Rn,k is given as the convolution between an exponential distribution and the law of the minimum of Brownian motion on the discrete grid Ikn. The latter converges to the law of the minimum of W on [0, 1], but the simulations
confirm the known feature that the laws deviate rather strongly around zero
for moderate discretisations. Let us state and prove a slightly more general
result.

Proposition 3.1. Choose hn according to (2.4). Consider t  Tkn for

fixed k and suppose that Xt = Xkhn +

t khn



dWs, t



Tkn.

Then

in

the

PPP

model (1.2) for all x  R

(3.2)

1
P h-n 1/2Rn,k > x = E exp - K (x + Wt)+ dt .
0

9

Proof. By conditioning on the Brownian motion we infer from the PPP properties of (Tj, Yj):

P h-n 1/2Rn,k > x W

= exp = exp

x h1n/2 +Xkhn
- t,y
Tkn -



- n

Tkn

xhn1/2 - (Wt - Wkhn )

dt
+

.

Noting that WØ s = h-n 1/2(W(k+s)hn - Wkhn), s  [0, 1], is again a Brownian motion, the result follows by rescaling and taking expectations.

For the regression-type model the survival function is asymptotically of the same form.

Proposition 3.2. Choose hn according to (2.4). Suppose that Xt =

Xkhn +

t khn



dWs,

t



Tkn,

for

a

fixed

bin

number

k.

Then

in

the

regression-

type model (1.3) for all x  R

(3.3)

1

lim
n

P

hn-1/2Rn,k > x

= E exp

- K (x + Wt)+ dt
0

.

The approximation error due to non-constant  and drift is considered in detail in Appendix A.1 and proved to be asymptotically negligible. This way, the asymptotic analysis of our estimation problem leads into the theory of Brownian excursion areas. Let Rt be a real random variable distributed as limn hn-1/2Rn, th-n 1 . The law of Rt determines (t2) via

(3.4)

Var(Rt)

=

1 2

(t2)

.

The Feynman≠Kac formula gives a connection of the right-hand side in Proposition (3.1) to a parabolic PDE based on the heat semigroup for Brownian motion. We can prove the following explicit result on the Laplace transform which determines the distribution of (Rt), t  [0, 1].

Proposition 3.3. The Laplace transform (in t) of

t E exp - 2 (x + Ws)+ ds
0

with   R satisfies the following identity:

 E


exp

 - st - 2

t
(x + Ws)+ ds



dt

=

-

2 3

s(x,

),

00

10 M. BIBINGER, M. JIRAK & M. REISS

with s(x, ) = s,-(x, )1(-,0)(x)+s,+(x, )1[0,)(x) defined by the func-

tions

  1/3Gi

 -2/3s

-

sGi-2/3

 s

+

2/3

s-1/2

s,+(x, ) =

sAi-2/3s

-

1/3Ai

 -2/3s

    ◊ Ai 21/3x + -2/3s + Gi 21/3x + -2/3s ,









s,-(x, ) =

2/3s-1/2Ai -2/3s + 1/3AI -2/3s

sAi-2/3s

-

1/3Ai

 -2/3s

- s-12/3

◊

exp

 2sx)

+

s-12/3

,

where Ai is the Airy function which is bounded on the positive half axis,


Ai(x) = -1 cos (t3/3 + xt) dt ,
0

and Gi is the Scorer function bounded on the positive half axis


Gi(x) = -1 sin (t3/3 + xt) dt ,

0

and we define AI(x) =

 x

Ai(y)dy.

This result generalizes the Laplace transform of the exponential integrated positive part of a Brownian motion derived by [22]. Inserting x = 0 and setting  = 1 renders the result by [22]. An inversion of the Laplace transform in Proposition 3.3 in order to obtain an explicit form of the distribution function and then  appears unfeasible as several experts vainly attempted to solve related problems, see [22] and [16]. Exploiting the strong Markov property of Brownian motion together with hitting times, we are able to circumvent this problem in our study of (2), for details we refer to the Appendix.
We formulate now the main convergence results whose proofs are given in the Appendix. For that we impose some regularity on the drift and diffusion coefficient which are also assumed to be deterministic or more generally independent of the driving Brownian motion W . Moreover, we need that the function  is invertible and sufficiently regular, which by Proposition A.2 below is ensured by a sufficiently large choice of K, but at least numerically seems to be the case for much smaller choices, cf. Figure 3 and [5].

Assumption 3.4. The drift as in (1.1) is bounded and Borel-measurable, the volatility t in (1.1) is a Lipschitz function that does not vanish, t > 0. The constant K in the definition (2.4) of hn is chosen large enough that Proposition A.2 below applies.

11

Theorem 3.5. Grant Assumption 3.4, choose hn according to (2.4) and rn = n-1/3 for some  > 0. Then the estimator (2.6) based on observations
from the PPP-model satisfies

(3.5)

IV

hn,rn n

-

1
s2 ds

=

 OP n-

1 3



.

0

Based on the same strategy of proof we can obtain an analogous result for the regression-type model.

Corollary 3.6. Grant Assumption 3.4, choose hn according to (2.4) and rn = n-1/3 for some  > 0. Then the estimator (2.8) based on obser-
vations from the regression-type model satisfies

(3.6)

IV

hn,rn n

-

1
s2 ds

=

OPn-

1 3



.

0

4. Lower bound for the rate of convergence. Consider our PPP-
model (1.2). We show that even in the simpler parametric statistical experiment where Xt = Wt, t  [0, 1], and  > 0 is unknown the optimal rate of convergence is n-1/3 in a minimax sense. This lower bound for the paramet-
ric case then serves a fortiori as a lower bound for the general nonparametric
case. A lower bound for the discrete regression-type model is obtained in a
similar way; in fact the proof is even simpler, replacing the Poisson sampling (Tjs) below by a deterministic design of distance n-2/3.

Theorem 4.1. We have for any sequence of estimators ^n2 of 2  (0, ) from the parametric PPP-model for each 02 > 0, the local minimax lower bound

 > 0 :

lim inf
n

inf
^n

max
 2 {02 ,02 + n-1/3 }

P2 (|^n2

-

2|



n-1/3)

>

0,

where the infimum extends over all estimators ^n based on the PPP-model (1.2) with  = 1 and Xt = Wt. The law of the latter is denoted by P2.

The proof falls into three main parts. We first simplify the problem by considering more informative experiments. These reductions are given in the two steps below. Then, in the third step we use bounds for the Hellinger distance. The more technical step 3 is worked out in Appendix B.
1. A PPP with intensity  is obtained as the sum of two independent PPPs with intensities r and s, respectively, satisfying  = r + s,

12 M. BIBINGER, M. JIRAK & M. REISS

see e.g. [20]. Hence, for b > 0 the experiment of observing (Tir, Yir)i1 from a PPP with regularised intensity density

r(t, y) = n

 (y

-

Xt)+/b2



1

and independently (Tjs, Yjs)j1 from a PPP with discontinuous intensity density s =  - r is more informative. We now provide even more information by replacing (Tjs, Yjs)j1 by (Tjs, XTjs)j1, the direct observation of the martingale values at the random times (Tjs). A lower bound proved for observing (Tir, Yir)i1 and (Tjs, XTjs)j1 independently thus also applies to the original (less informative) observa-
tions. 2. Due to s(t, y)dt dy = (2/3)nb, we conclude that the times (Tjs) are
given by a Poisson sampling of intensity (2/3)nb on [0, 1] and there are a.s. only finitely many times (Tjs)j=1,...,J . Let us first work conditionally on (Tjs) and put T0s = 0, TJs+1 = 1. All observations of (Tir, Yir)i1 with Tir  [Tjs-1, Tjs) are transformed via

(Tir, Yir) 

Tir - Tjs-1, Yir -

XTjs-1

Tir Tjs

- -

Tjs-1 Tjs-1

+

XTjs

Tjs - Tir Tjs - Tjs-1

.

Noting that (Bt - (t/T )BT , t  [0, T ]) defines a Brownian bridge B0,T on [0, T ], we thus obtain conditionally on (Tjs) for each j = 1, . . . , J +1 observations of a PPP on 0, Tjs - Tjs-1 with intensity density

j(t, y) = n

 b-1 y

-

Bt0,Tjs

-Tjs-1


+



1

.

The transformation has rendered the family of PPPs with intensity densities (j)j=1,...,J+1 independent by reducing the Brownian motion to piecewise Brownian bridges. Conditionally on (Tjs) we thus have independent observations of (Tjs, XTjs)j=1,...,J and independent PPPs with intensity densities (j)j=1,...,J+1.
By using the latter more informative experiment and by choosing b  n-1/3 we show below that for a Poisson sampling (Tjs)j=1,...,J on [0, 1] of intensity (2/3)nb  n2/3 of direct observations XTjs as well as for independent observations of PPPs, generated by  times a Brownian bridge in-between the sampling points (Tjs)j, we cannot estimate at a better rate than n-1/3. This is accomplished by bounding the Hellinger distance between the experiments for 2 = 02 and 2 = 02 + n-1/3.

13

5. Conclusion. We have modeled the relationship between limit order book bid and ask quotes and an efficient price process by a stochastic frontier model. The model does not attempt to describe the fine structure of order book dynamics, but is only based on the natural ordering between quotes and prices. This agnostic point of view seems attractive for statistical purposes. Still, we find n-1/3 as optimal convergence rate of integrated squared volatility estimators which improves upon the n-1/4-rate, known for transaction price models with regular microstructure noise.
The estimation approach uses local order statistics and a coarse-fine grid approximation whose analysis is connected to a Brownian excursion problem. Owing to the nonlinear and implicit definition, finer properties of the estimator like its asymptotic distribution remain open. First numerical results in [5] are in any case promising. An empirical validation, using the three data sets of bid and ask quotes and transaction prices independently, is feasible.

APPENDIX A: PROOFS OF SECTION 3

Proposition 3.2 considers the simplified model where Xt, t  Tkn, is ap-

proximated by Xkhn +

t khn

khn

dWt.

The

resulting

approximation

error

is bounded within Proposition A.1 for the PPP-model and an analogous

proof carries over to the regression-type model. From here on An Bn
expresses shortly that An  K ∑ Bn for two sequences An, Bn and some
real constant K < . We write A+ = A1(A  0), A- = |A|1(A  0) and
Z p = E[|Z|p]1/p, p  1.

Proof of Proposition 3.2. By law invariance of Rn,k with respect to k for Xt = X0 + Wt, we can simplify

P(h-n 1/2Rn,k > x) = P

hn-1/2

min
i=0,...,nhn

-1(Xi/n

-

X0

+

i)

>

x

=P

min
i=0,...,nhn

-1(Wi/(nhn

)

+

-1hn-1/2i)

>

x

,

where we used that h1n/2Wt/hn is another Brownian motion. We condition on the driving Brownian motion W = (Wt, t  [0, 1]) and obtain in terms of
the distribution function F of i:

P(hn-1/2Rn,k > x) = E

nhn-1  P i > hn1/2(x - Wi/(nhn))

 W

i=0

nhn-1

= E exp

log 1 - F(hn1/2(x - Wi/(nhn)))

i=0

.

14 M. BIBINGER, M. JIRAK & M. REISS

The expansion (1.4) of F together with expanding the logarithm therefore yields

nhn-1

P(hn-1/2Rn,k > x) = E exp - hn1/2

(x - Wi/(nhn))+(1 + O(1)) ,

i=0

where O(1) is to be understood -wise and holds uniformly over i and n

whenever maxt[0,1](x - Wt())+ is bounded. By the choice of hn we have

h1n/2 = K(nhn)-1 and the integrand is a Riemann sum tending almost

surely to exp(-K

1 0

(x

-

Wt)+dt).

Noting

that

a

conditional

probability

is

always bounded by 1, the assertion follows by dominated convergence and

use of -W =d W .

Proof of Proposition 3.3. Throughout the proof, we drop the dependence on  in s(x, ), s,-(x, ) and s,+(x, ) to lighten the notation. We shall apply the Kac formula in the version as in formulae (4.13) and (4.14) of [19]. It connects the considered Laplace transform with the solution of a differential equation which becomes in our case:

(A.1a) (A.1b)

d2 dx2

=

2s

- 22/3

d2 dx2

=

 2( 2x + s)

- 22/3

, x < 0, , x > 0.

Since all assertions necessary to apply the Kac formula are fulfilled, the

Laplace transform from above multiplied with a constant Lagrangian 2/3

satisfies



t



E 2/3 exp - st - 2 (x + Ws)+ ds dt = s(x) .

00

The general solution of (A.1a) is given by

(A.2a)

  s,-(x) = A exp 2sx + 2/3s-1 ,

with a constant A (depending on s but not on x). Airy's function Ai solves the homogenous differential equation of the type (A.1b), whereas the Scorer function Gi is a particular solution of the inhomogenous equation  - x = -1, both being bounded on the positive real line. Hence, a solution ansatz for (A.1b) is given by
    (A.2b) s,+(x) = BAi 21/3x + -2/3s + Gi 21/3x + -2/3s ,

15

with a constant B. Continuity conditions on  and d/dx at x = 0 give rise

to

  1/3Gi

 -2/3s

-

sGi-2/3

 s

+

2/3s-1/2

B=

sAi-2/3

 s

-

1/3Ai

 -2/3s

.

In order to express A in a more concise and simple manner, we exploit the following relation for the Wronskian of Ai and Gi:

(A.3)


 Gi (x)Ai(x) - Ai (x)Gi(x) = AI(x) = Ai(y) dy .
x

A proof of the latter equality can be found in [26]. Thereby, we obtain









A=

2/3s-1/2Ai -2/3s + 1/3AI -2/3s

sAi-2/3s

- 1/3Ai

 -2/3s

- s-12/3

.

This result concludes the proof.

A.1. Asymptotic analysis of the estimator. As a first step, we extend Proposition 3.1 by analysing the approximation error due to neglecting the drift and assuming a locally constant volatility. Then we prove Theorem 3.5 exploiting properties of  which are established in Appendix A.2.

Proposition A.1. Consider hn in (2.4) and t  Tkn for fixed k. Then

 1

P

min
jTkn

Yj

- Xkhn

>

xkhn

hn

= E exp

- Kkhn (x + Wt)+dt
0

+ nhn5/2G(x),
 where |G(x)|  CP |W1|  C2xkhn/2 , with C1, C2 > 0.
If t is constant and at = 0 for t  Tkn, then G(x) = 0.

Proof. Proposition 3.1 already (-, z] and z = xkhn hn. Let

gives the Xt(k)

last statement.

=

t khn

s

dWs

Let and

Az = Tkn At(k)

◊ =

t khn

as

ds.

Then,

using

basic

properties

of

a

PPP,

it

follows

that

  

P

min
jTkn

Yj

-

Xkhn

>

z

= E P  Az = 0 X

= E exp - (Az)

= E exp

1- n Az

{Xt(k)+At(k)y} dt dy

(A.4)

= E exp - n (z - Xt(k) - At(k))+ dt .
Tkn

16 M. BIBINGER, M. JIRAK & M. REISS

Introduce

Tk = n (z - Xt(k) - At(k))+dt ,
Tkn

(k+1)hn 



Vk = n
khn

z - khn (W(k+1)hn

- Wkhn )

dt ,
+

(k+1)hn t

Uk = n
khn

(s
khn

-

khn )dWs

dt

and

Ak

=

nh2n

max
tTkn

akhn

-

at

.

Then we have the upper and lower bounds

Vk - Uk - Ak  Tk  Vk + Uk + Ak.

By scaling and symmetry properties of Brownian motion, we have that

Vk =d nkhn h3n/2

1
(x + Wt)+dt = Kkhn

1
(Wt + x)+ dt.

00

As a first objective, we derive an upper bound for E exp - yTk , y > 0. To this end, note that by the Dambis-Dubins-Schwarz Theorem (Thm. 4.6 in [19])

Xt(k) =d W X(k),X(k) t .

Since

X(k), X(k) t =

t khn

s2

ds

for

t



khn,

we

deduce

P

sup |Xt(k)|  z/2
tTkn

 P sup |Wt|  Ckhnx
0t1


 2P |W1|  Cxkhn/2 ,

with some C > 0. By the boundedness of at, it follows that

(A.5)

Ak

nhn2

max
t[0,1]

|at|

n-1/3.

We thus obtain for y > 0 the upper bound

(A.6)

 E exp - yTk  2P |W1|  C1xkhn/2

+ exp - C1xynhnkhn /2 + C2yn-1/3 ,

where C1, C2 > 0 are finite constants. This also supplies a bound for E[exp(-yVk)]. Next, observe that

Uk  nhn sup

t (s - khn )dWs d=ef Uk+.

khnt(k+1)hn khn

17

Using the law of the maximum of (time-transformed) Brownian motion, we

see

Uk+ =d nhn

(k+1)hn
(s - khn)2ds|Z| with Z  N (0, 1).
khn

By the Lipschitz property of t, the integral is of order hn3 . We obtain by Cauchy-Schwarz inequality

E exp - Tk  E exp - Vk  E exp - Vk + exp - Vk

+ exp …
exp
2

 - Vk 2 exp(Uk+) - 1 2 C(nhn5/2)2 - 1

 E exp - Vk

+ E exp

- 2Vk

1/2
C

nhn5/2,

with some constants C, C , noting nh5n/2  0. Combining the above with K > 1, we thus conclude for some constant C:

E exp - Tk

 E exp - Vk  E exp - Vk

+C exp - Vk 

2nh5n/2



+ Cnhn5/2P |W1|  Cxkhn /2 .

In the same manner, one obtains a lower bound, and the claim follows.



mnP,2rk-o1of2

of Theorem 3.5 and Corollary 3.6. 2hn-1rn and an,l = lrn-1/2, sn,l = lhnrn-1 =

Let Mk,n 2an,lhn. It

= mn,2k - follows with

(A.14) that

an,l 



E[Mk,n] - 2rn(s2n,l-1 )

k=an,l-1 +1

hn

+

sup
sn,l-1 tsn,l

(t2)

-

(s2n,l )

.

Proposition A.2 and the Lipschitz continuity of t yield that

sup
sn,l-1 tsn,l

(t2)

-

(s2n,l-1 )

sup t - sn,l
sn,l-1 tsn,l

rn.

We thus conclude

(A.7)

k,n

hn + rn for k,n=

an,l 



E[Mk,n] - 2rn(s2n,l-1 ) .

k=an,l-1 +1

 Next, we have that MØ k,n = Mk,n - E Mk,n is a sequence of independent random variables. Proposition A.1 yields that all moments of MØk,n exist.

18 M. BIBINGER, M. JIRAK & M. REISS

¶© Hence for any index set J  0, . . . , h-n 1 -1 , Rosenthal's inequality ensures that for any p  1

(A.8)

MØ k,n

kJ

p

… rn J ,

where J is the cardinality of the set J . Let

® Ml =

an,l

 ´

MØ k,n + 

2
sn,l-1

/2 > 0

,

k=an,l-1 +1

h-n 1-1

and M =

Ml.

l=1

 Note that Proposition A.2 yields that  x2 > 0 for x > 0. Then we obtain

from the Markov inequality and (A.8) that

h-n 1-1

 hn-1-1 



P

Mlc 

P Mcl

l=0 l=0

2p

h-n 1-1





2
sn,l-1

-p

an,l

p

MØ k,n

l=0

k=an,l-1 +1

p

(A.9)

hn-1 -1



rnp/2 = O 1 ,

l=0

for p > 4. We are now ready to proceed to the main proof. From (2.6) it follows that

IV hn,rn -

1 rnh-n 1

0

t2 dt =

l=1

2
sn,l-1

hn

rn-1

-

1
t2 dt
0

rn hn-1
+ -1

an,l
(mn,2k - mn,2k-1)22 hn-1rn

l=1 k=an,l-1+1

-

2
sn,l-1

hnrn-1.

Consider first the approximation error in the quadratic variation by setting the volatility locally constant on the blocks of the coarse grid. By the boundedness and Lipschitz continuity of t we can estimate the approximation error:

rn hn-1 l=1

sn,l sn,l-1

 2
sn,l-1

-

 t2

dt

rn hn-1
 2 t 
l=1

sn,l
sn,l-1 - t dt
sn,l-1

= O hnrn-1 = O n-1/3 .

19

In order to bound the remaining estimation error

rnh-n 1 l=1

-1

an,l
Mk,n
k=an,l-1 +1

-

2
sn,l-1

hnrn-1,

we use a Taylor expansion and that the first two derivatives of -1 exist and

are bounded according to Proposition A.2 below. More precisely, it follows

that

 -1

an,l

   

Mk,n - 

2
sn,l-1

+

2
sn,l-1

k=an,l-1 +1

 

 an,l 



=

2
sn,l-1

+

-1

(s2n,l-1 )

Mk,n - E[Mk,n] + k,n

k=an,l-1 +1

+

1 -1 2

  l

an,l

 2 Mk,n - E[Mk,n] + k,n

k=an,l-1 +1

d=ef

2
sn,l-1

+

 
l,1

+

  ,
l,2





where l   and set Zl =

kas2n=n,al,ln-,1l-1/+21>M0k,non-

the set Ml. We E[Mk,n] . Using

first deal with  the independence

 of

l,1
Zl,

it follows from (A.8) that

(A.10)

rnh-n 1-1

 (s2n,l-1 ) Zl

2

l=1 2

rnh-n 1

2

Zl 2

l=1

rn2 h-n 1

=

 O1.

On the other hand, we obtain from (A.7) that

(A.11)

rnhn-1



 an,l

-1 (s2n,l-1 )

k,n

l=1 k=an,l-1+1

rn2 h-n 1

=

 O1.

Combining (A.10) and (A.11), we find

(A.12)

rnhn-1  



  l,11M = O 1 .

l=1 2

In the same manner, but using additionally (-1) (l)1Ml  <  by
Proposition A.2 below, we obtain

rnhn-1  
  l,21M
l=1 1

rnh-n 1 l=1

2

Zl

+
2

an,l
k,n
k=an,l-1 +1

2

= O(1).

20 M. BIBINGER, M. JIRAK & M. REISS   
Since P Mc = O 1 by (A.9), this suffices to guarantee that
IV hn,rn - 1 t2 dt = OPn-1/3 .
0
Based on a Taylor expansion for -n 1 and using analogous bounds and Proposition A.3, we obtain likewise
IV hn,rn - 1 t2 dt = OPn-1/3 .
0
and conclude Corollary 3.6.

A.2. Properties of . We shall use the following identities for mo-

ments of real random variables:

(A.13a)

 







E X = P X > x dx - P -X > x dx ,

00

(A.13b)











E X2 = 2 xP X > x dx + 2 xP -X > x dx .

00

It follows from Proposition A.1 and (A.13a), (A.13b) that for ~ () = (2)

(A.14)

h-n 1E(mn,k

-

 mn,k-1)2

=

~ ()

+

 O nh5n/2 .

Having understood the behaviour of ~ (), analogue properties of (2) readily follow. Let

(A.15)

1
H(x) = (Wt + x)+ dt.
0

Then by (A.13a), (A.13b), we derive

 ~  = 42



 xE

e-KH


(x)

+

1

-

E

e-KH

(-x)dx

(A.16)

0

 - 22

 E

e-KH


(x)

-

1

+

E

e-KH

(-x)dx2.

0

Next, consider the distribution on the negative half axis. With x < 0, we

make the decomposition



E

e-K

1 0

(Wt

-x)-

dt

 = E e-K

101(Wt-x)-dt 

inf
0t1

Wt



 x

+


1

inf
0t1

Wt



 x

d=ef U1(x) + U2(x).

21

Let Tx be the first passage time of W to level x with density

fTx (t)

=

|x| e-x2/2t , t 2t3



0,

¶ ©¶

©

see (6.3) in Section 2.6 of [19]. From Tx  1 = inf0t1 Wt  x it

follows from the strong Markov property of W that

U1(x) = =



1
E

e-K

1 s

(Wt

-x)-

dt

Tx

=

s

fTx (s)ds

0

1
E

e-K


1-s
0 (Wt)-dt fTx (s)ds.

0

Using a time shift yields



U1(x) =

1
E

e-K(1-s)3/2

1 0

(Wt

)-

dt

fTx (s)ds.

0

We then obtain that

 E e-K



1 0

(Wt

-x)-

dt

=



P

inf
0t1

Wt



 x

+



1
E

e-K(1-s)3/2

0

 01(Wt)-dt fTx (s)ds

(A.17)

d=ef



P

inf
0t1

Wt



 x

+

A-(x),

for x < 0.

 Let I(K, s) = E e-K(1-s)3/2 01(Wt)-dt . Then by (A.17)



 x1

-

E

e-KH (-x)

 dx

=

0

 0

 xP

inf
0t1

Wt

<

 -x

-

A-

 (-x) dx

 1

=
0

xP( inf
0t1

Wt

<

-x)dx

-

0

I(K, s)

0

xfTx (s)dxds

1 11

=-

I(K, s)ds,

2 20

since

 0

xP(inf 0t1

Wt

<

-x)dx

=

1 2

.

Likewise,

it

follows

that

 

 1
0

-

E

e-KH (-x)

 dx

=


 0



P

inf  0t1

Wt

<

 -x dx

-

2 

2 21

(A.18)

=-

I(K, s)ds.

 0

1
I(K, s)ds
0

22 M. BIBINGER, M. JIRAK & M. REISS

We thus obtain

 ~ 

=

 42
- 22 

00xEEee--KKHH(x(x))ddxx+-12 -2

1 2
+

1
 0



I(K, s)ds

21

2

I(K, s)ds

0

(A.19) = 22 21() - 22() ,

with functionals 1, 2. In the sequel, we write kf (x) = kf (x)/kx. The further analysis of properties of ~ is structured in several lemmas which
combined imply the following key proposition.

Proposition A.2. Suppose that   0 > 0, K  C(0) for C(0) sufficiently large (the exact value of C(0) follows from (A.24)). Then we have uniformly for   0

(A.20)

~ 

=

4

 1

-

2

+

O



2
3

K

1 3

~ 

=

22

 1

-

2

+

O



2
3

K

1 3

> 0 and > 0.

Moreover, it holds that

(A.21)

sup k~ () <  for k = 1, 2.
0

Using the relation

(A.22)

~ -1(

)=

1 ~ () ,

~ () = ,

we get that the second derivative is uniformly bounded for   0 = ~ -1( 0), i.e.

(A.23)

sup 2~ -1( )
0

2~ ()

=

sup
0

~ ()3

< .

So far we have focused on results for ~ () = (2). Essentially the same results are valid for n(2), which we state now.

23

Proposition A.3. Introduce





Bn,1 =

xP

0 



max
0inhn

-1

Wi/(nhn

)



x 

dx

Bn,2 =
0

P

max
0inhn

-1

Wi/(nhn

)



x

dx,

and

»

which satisfy Bn,1 

1 2

,

Bn,2





2. Then

(A .20) and

(A.21) in Proposition

A.2 remain valid if we replace ~ 

with n 2

and

1-

2 

with

2Bn,1 -Bn2 ,2 .

Likewise, (A.23) also holds.

Proof of Proposition A.2. We write shortly 1 = 1(), 2 =

2(). We have that

~ 

=

 4 21

-

 22

+

22

(21

-

222)

.

Using Lemmas A.4 and A.7 from below, we obtain with (A.19)

1

-

1 2



6(K

)-

2 3

+

3 2



K

-

2 5

log(K)

d=ef

R1

 

2 -

2 

2

  2 

+1

(K)-

1 3

+

  2
3 



K

-

2 5

log(K)

d=ef R2 .

Moreover, applying Lemmas A.5, A.6 and A.7 yields

1



 6 K3

-

1 2

+

3 2



K

-

2 5

log(K)

d=ef

R1 ,

22



2 ,


22



 R2

+

   2



41



+

(2

)-

1 2

 K-

1 3

-

4 3

+

  2 

3 



K

-

2 5



log(K)

d=ef R2 .

We thus obtain from the above that

~

-

 4 1

-

2



  4 2R1 + R2

  2
R2 + 2 



 + 42 R1 + R2 = O

K-

1 3



2 3

,

  ~ - 22 1 - 2


  

 22 R1 + R2 R2 + 2

2 

=O

K-

1 3



2 3

.

24 M. BIBINGER, M. JIRAK & M. REISS

An explicit sufficient lower bound for K in terms of 0 can be computed

from the two conditions

 

22

1- > 

2R1 + R2 R2 + 2



 +  R1 + R2 ,

(A.24)

   22
1 -  > R1 + R2 R2 + 2  .

It remains to show the boundedness property for the first two derivatives of ~ . By Lemma A.8, we have

(A.25)

 kJ 



C

 1

+

 -k 

,

k = 1, 2,

 where J  = 21() - 22() and C is a constant not depending on . Observe that
2~ = 4J + 6J + 22J,

hence the claim follows.

Proof of Proposition A.3. The proof can be redirected to Proposition A.2 using Proposition 3.2 and a truncation argument for the integrals over x. The corresponding computations are very similar to those above and the Lemmas given below. We therefore omit the details.

Lemma A.4. For K > 0, p  N0, we obtain the following decay behaviour of the moment integrals:





xpE e-KH(x) dx  2p+1

0

E[|Z|p+1] + (p + 1) p+1

(K)-(p+1)/3

with Z  N (0, 1).

Proof of Lemma A.4. The following useful relation in terms of the

N (0, 1)-distribution function  is derived from the law of the minimum

of Brownian motion:

(A.26)





P Tx  l = 2(1 - (|x|/ l)).

25

Then for 0 < l < 1

 xpE e-KH(x) dx 

 



xpE 1 T-x/2  l dx

00

+



xpE

e-KH


(x)1 T-x/2

>

 l dx

d=ef

R1

+

R2

.

0

By (A.26) we have

 R1 = 2 xp(1 - (x/ 4l)) dx
0
= (4l)(p+1)/2  2zp(1 - (z)) dz = (4l)(p+1)/2 E[|Z|p+1] . 0 p+1

We further note that T-x/2 > l implies H(x)  0l(-x/2 + x)+dt = lx/2, such that

R2 

 xpe-Klx/2dx =

2

p+1 



 p+1 .

0 Kl

Choosing l = (K)-2/3, we obtain

 xpE e-KH(x) dx 
0

2p+1 E[|Z|p+1]

+

 2p+1 p

+

 1

(K)-(p+1)/3,

p+1

as asserted.

Lemma A.5. Let K > 0. Then



E

 KH

(x)e-KH(x)

dx



 41

+

1/2K-1/3-4/3.

0

Proof of Lemma A.5. We make the decomposition



 



E KH(x)e-KH(x) dx =

E 1(T-x/2  l)KH(x)e-KH(x) dx

00

+



E


1(T-x/2

>

l)KH

(x)e-KH


(x)

dx

,

0

with some l > 0. Using ye-y  1 and (A.26), we obtain







E 1(T-x/2  l)KH(x)e-KH(x) dx  2 (1 - (x/ 4l)) dx

0 »0

= 8l/.

26 M. BIBINGER, M. JIRAK & M. REISS

Now, using ye-y  e-y/2 and T-x/2 > l  H(x)  lx/2, we bound the other term by



E


1(T-x/2

>

l)KH(x)e-KH(x) dx



0


e-Klx/4dx
0

=

4 Kl

.

The choice l = (K)-2/3 and division by  yield the claim.

Lemma A.6.

Let K > 0. Then





xE KH(x)e-KH(x) dx

0



6 K1/23/2 .

Proof of Lemma A.6. We proceed as in the proof of Lemma A.5 and obtain for any l > 0







xE KH(x)e-KH(x) dx  x 2(1 - (x/ 4l)) + e-Klx/4 dx

00

= 2l + (Kl/4)-1.

The result follows with l = (K)-1/2.

Lemma A.7. Let K  -1. Then

1
I(K, s)ds  3

K

-2/5
,



1 0

I

(K,

s)ds

3

K

-2/5
.

0

log(K)

  log(K)

Proof of Lemma A.7. With (s) = K(1-s)3/2 we obtain for any T > 0

1
I(K, s)ds =
0


1
E

e-(s)

01 (Wt )- dt

ds

0

11

P (s) (Wt)-dt  T

00

+ e-T

ds.

From

01(Wt)-dt  |Z| with Z =

1 0

Wt

dt



N (0, 1/3),

we

deduce

P( 01(Wt)-dt  )  ,  > 0, and thus



1 0

I

(K,

s)ds



1

T -1(s)-1  1 ds + e-T .

 0

Using ((s))-1  (K/T )3/5 for s  1 - (K/T )-2/5 the last integral is bounded by 2(K/T )-2/5. The choice T = log(K) yields the first inequality.

27

Then using ye-y  e-y/2 we also obtain



1 0

I

(K,

s)ds



=

1
E (s)
0

1
(Wt)-dt

e-(s)

1 0

(Wt

)-

dt

0

ds

11

 -1

P (s) (Wt)-dt  T + e-T/2 ds.

00

The previous bounds now apply in the same way.
 Lemma A.8. Consider J  = 21() - 22(). Then there exists a constant B = B(K) > 0 only depending on K such that

(A.27)

 kJ   B(1 + -k), k = 1, 2.

Proof of Lemma A.8. Without loss of generality, we may assume that

K= 1. From the considerations below, existence of the k'th derivative of

cJonsidwerith0rexsEpecet-toH

 follows. We thus focus (x) dx. An application of

on the

establishing (A.27). First Cauchy-Schwarz inequal-

ity gives

k

 0

xE

 e-H (x)

dx

k

=


xE

 -H

(x)k e-H

(x)

dx

0

(A.28)





xE

 H

(x)2k 1/2

E

e-2H

(x)

1/2

dx.

0

Applying the triangle and Cauchy-Schwarz inequality further yields

(A.29)

E

 H

(x)2k

1/2



E



1 2k 1/2 |Ws|ds + |x|

0

1  xk.

» The calculations in the proof of Lemma A.4 with l = x//2 yield

(A.30)

E[exp(-2H(x))] exp(-x3/21/2/2).

Combining (A.29) and (A.30), we deduce that



xE

 H

(x)2k

1/2

E

e-2H (x) 1/2

dx

0
  x  xk+1 exp(-x3/21/2/2) dx

0

-2/3(1 + -k/3).

28 M. BIBINGER, M. JIRAK & M. REISS

This implies that for some C > 0

(A.31)

k

 0

xE

 e-H (x)

dx

k

 C-2/3(1 + -k/3) .

Arguing in the same manner, one also establishes that

(A.32)

k

 0

E

 e-H


(x)

dx

k

 C-1/3(1 + -k/3) .

Moreover, such bounds are also valid for the derivatives of

1 0

I

(,

s)ds.

APPENDIX B: PROOF OF THEOREM 2

After the reductions of the problem to a simpler and more informative
experiment, we now prove Theorem 4.1 using properties of the Hellinger distance H(P, Q) between probability measures, in particular H2(P1  P2, Q1Q2)  H2(P1, Q1)+H2(P2, Q2) (subadditivity under independence), H2(P, Q) = E[H2(P, Q|T )] (Hellinger distance conditional on a statistic T )
and
H2(P P P (1), P P P (2))  ( 1 - 2)2

(Hellinger bound for PPP measures with intensity densities i, cf. [21]). Put n = 05/3n-1/3. From H2(N (0, 02), N (0, 02 + n))  2(n0-2)2,
cf. Appendix in [23], and the independent increments of Brownian motion
we infer for the Hellinger distance of the laws of (XTjs)j=1,...,J under 02 and 02 + n

H2

P (XTjs
02

)

,

P(X02+Tjsn)

(Tjs)

J
 2n2 0-4 = 2J n2 0-4.
j=1

For each PPP with intensity density j we obtain by integral calculations, in terms of  = (02 + n)1/2 - 0:

H2 P P P (j (02)), P P P (j (02 + n)) (Tjs), B0,Tjs-Tjs-1

Tjs -Tjs-1
n
0R

 b-1 y

-

0Bt0,Tjs-Tjs-1


+

1

-

 b-1 y

-

(02

+

n

)1/2Bt0,Tjs

-Tjs-1


+

2
 1 dy dt

= nb  nb

Tjs -Tjs-1 0

R

u+



1

-

 u

-

b-1

Bt0,Tjs

-Tjs-1


+



1

Tjs-Tjs-1 b-22(Bt0,Tjs-Tjs-1 )2dt.

0

2
dy dt

29

Hence, by using the variance of a Brownian bridge we arrive at

H2 P P P (j(02)), P P P (j(02 + n)) (Tjs)

 nb-12

Tjs -Tjs-1 0

t(1

-

(Tjs

-

Tjs-1)-1t) dt

=

n2 6b

(Tjs

-

Tjs-1)2.

Since conditional on (Tjs) all observations are independent, the total squared Hellinger distance conditional on (Tjs) is bounded by

2J n2 0-4

+

n2 6b

J +1
(Tjs
j=1

-

Tjs-1)2.

Taking expectations and using J  Poiss(2nb/3), Tjs-Tjs-1  Exp(2nb/3) to apply the Wald identity to the second sum, the unconditional total Hellinger
distance is bounded by

H2



4nbn2 304

+

n2 (2nb/3)-1(1 6b

+

o(1)).

We

have

2



1 2

n2 0-2

due

to

 1+x



1 + x/2

for

x

>

0

and

thus

by

choosing b  (02/n)1/3 optimally and plugging in n

H2



2n1/304/3

inf
b>0

2b C 302 + 12b2n

 C 2.

From the general lower bound Theorem 2.2(ii) in [25] we thus obtain the result if  is chosen smaller than 2/C .

REFERENCES
[1] A®it-Sahalia, Y., Mykland, P. A. and Zhang, L. (2005). How often to sample a continuous-time process in the presence of market microstructure noise. Review of Financial Studies, 18, 351≠416.
[2] Bacry, E. and J.F Muzy (2013) Hawkes model for price and trades high-frequency dynamics. preprint, arxiv:1301.1135
[3] Barndorff-Nielsen, O. E., Hansen, P. R., Lunde, A. and Shephard, N. (2008). Designing realised kernels to measure the ex-post variation of equity prices in the presence of noise. Econometrica 76 (6), 1481≠1536.
[4] Biais, B., Hillion, P. and Spatt, C. (1995). An empirical analysis of the limit order book and the order flow in the paris bourse. The Journal of Finance, 50 (5), 1655≠1689.
[5] Bibinger, M., Jirak, M. and Reiﬂ, M. (2014). Applying volatility estimators based on limit order books, Technical Report, available under www.mathematik.hu-berlin.de/for1735/Publ/application.pdf.

30 M. BIBINGER, M. JIRAK & M. REISS
[6] Bouchaud, J.P, Mzard, M. and Potters, M. (2002). Statistical properties of stock order books: Empirical results and models. Quantitative Finance, 2 (4), 251≠256.
[7] Carmona, R. and Lacker, D. (2014). A probabilistic weak formulation of mean field games and applications. The Annals of Applied Probability, to appear.
[8] Cle¥ment, E., Delattre, S. and Gloter, A. (2013). An infinite dimensional convolution theorem with applications to the efficient estimation of the integrated volatility. Stochastic Processes and their Applications, 123 (7), 2500≠2521.
[9] Cont, R., Stoikov, S. and Talreja, R. (2010). A stochastic model for order book dynamics. Operations Research, 58 (3), 549≠563.
[10] Cont, R., A. de Larrard (2012). Order Book Dynamics in Liquid Markets: Limit Theorems and Diffusion Approximations. preprint, SSRN: http://ssrn.com/abstract=1757861
[11] Foucault, T., Kadan, O. and Kandel, E. (2005). Limit order book as a market for liquidity. Review of Financial Studies, 18, 1171≠1217.
[12] Gatheral, J. and R. C. A. Oomen (2010). Zero-Intelligence Realized Variance Estimation. Finance and Stochastics, 14 (2), 249≠283.
[13] Gloter, A. and Jacod, J. (2001). Diffusions with measurement errors 1 and 2. ESAIM, Probability and Statistics, 5, 225≠242.
[14] Jacod, J., Podolskij, M. and Vetter, M. (2010). Limit theorems for moving averages of discretized processes plus noise. The Annals of Statistics 38 (3), 1478≠ 1545.
[15] T. Jaisson and Rosenbaum, M. (2014). Limit theorems for nearly unstable Hawkes processes. The Annals of Applied Probability, to appear.
[16] Janson, S. (2007). Brownian excursion area, Wright's constants in graph enumeration, and other Brownian areas. Probability Surveys 4, 80≠145.
[17] Meister, A. and Reiﬂ, M. (2013). Asymptotic equivalence for nonparametric regression with non-regular errors. Probability Theory and Related Fields 155, (1-2), 201≠229.
[18] Naes, R. and J. A. Skjeltorp (2006). Order book characteristics and the volumevolatility relation: Empirical evidence from a limit order market. Journal of Financial Markets, 9 (4), 408≠432.
[19] Karatzas, I. and S. E. Shreve (1991). Brownian motion and stochastic calculus. Second Edition. Volume 113 of Graduate Texts in Mathematics. New York: SpringerVerlag.
[20] Karr, A. F. (1991) Point processes and their statistical inference. Second edition. Probability: Pure and Applied, New York: Marcel Dekker, Inc.
[21] Kutoyants, Y. (1998) Statistical Inference for Spatial Poisson Processes. Lecture Notes in Statistics, Springer.
[22] Perman, M. and J. A. Wellner (1996). On the distribution of Brownian areas. The Annals of Applied Probability 6 (4), 1091≠1111.
[23] Reiﬂ, M. (2011). Asymptotic equivalence for inference on the volatility from noisy observations. The Annals of Statistics, 2, 772≠802.
[24] Rosu, I. (2009). A dynamic model of the limit order book. Review of Financial Studies, 22 (11), 4601≠4641.
[25] Tsybakov, A.B. (2009). Introduction to Nonparametric Estimation. New York: Springer-Verlag.
[26] Varlamov, V. (2008). Differential and integral relations involving fractional derivatives of Airy functions and applications. Journal of Mathematical Analysis and Applications 348 (1), 101≠115.
[27] Zhang, L., Mykland, P. A. and A®it-Sahalia, Y. (2005). A tale of two time

31
scales: Determining integrated volatility with noisy high-frequency data. Journal of the American Statistical Association 100 (472), 1394≠1411.
Markus Bibinger, Moritz Jirak, Markus Reiﬂ, Institut fu®r Mathematik Humboldt-Universita®t zu Berlin Unter den Linden 6 10099 Berlin, Germany

SFB 649 Discussion Paper Series 2014
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Principal Component Analysis in an Asymmetric Norm" by Ngoc Mai Tran, Maria Osipenko and Wolfgang Karl H‰rdle, January 2014.
002 "A Simultaneous Confidence Corridor for Varying Coefficient Regression with Sparse Functional Data" by Lijie Gu, Li Wang, Wolfgang Karl H‰rdle and Lijian Yang, January 2014.
003 "An Extended Single Index Model with Missing Response at Random" by Qihua Wang, Tao Zhang, Wolfgang Karl H‰rdle, January 2014.
004 "Structural Vector Autoregressive Analysis in a Data Rich Environment: A Survey" by Helmut L¸tkepohl, January 2014.
005 "Functional stable limit theorems for efficient spectral covolatility estimators" by Randolf Altmeyer and Markus Bibinger, January 2014.
006 "A consistent two-factor model for pricing temperature derivatives" by Andreas Groll, Brenda LÛpez-Cabrera and Thilo Meyer-Brandis, January 2014.
007 "Confidence Bands for Impulse Responses: Bonferroni versus Wald" by Helmut L¸tkepohl, Anna Staszewska-Bystrova and Peter Winker, January 2014.
008 "Simultaneous Confidence Corridors and Variable Selection for Generalized Additive Models" by Shuzhuan Zheng, Rong Liu, Lijian Yang and Wolfgang Karl H‰rdle, January 2014.
009 "Structural Vector Autoregressions: Checking Identifying Long-run Restrictions via Heteroskedasticity" by Helmut L¸tkepohl and Anton Velinov, January 2014.
010 "Efficient Iterative Maximum Likelihood Estimation of HighParameterized Time Series Models" by Nikolaus Hautsch, Ostap Okhrin and Alexander Ristig, January 2014.
011 "Fiscal Devaluation in a Monetary Union" by Philipp Engler, Giovanni Ganelli, Juha Tervala and Simon Voigts, January 2014.
012 "Nonparametric Estimates for Conditional Quantiles of Time Series" by J¸rgen Franke, Peter Mwita and Weining Wang, January 2014.
013 "Product Market Deregulation and Employment Outcomes: Evidence from the German Retail Sector" by Charlotte Senftleben-Kˆnig, January 2014.
014 "Estimation procedures for exchangeable Marshall copulas with hydrological application" by Fabrizio Durante and Ostap Okhrin, January 2014.
015 "Ladislaus von Bortkiewicz - statistician, economist, and a European intellectual" by Wolfgang Karl H‰rdle and Annette B. Vogt, February 2014.
016 "An Application of Principal Component Analysis on Multivariate TimeStationary Spatio-Temporal Data" by Stephan Stahlschmidt, Wolfgang Karl H‰rdle and Helmut Thome, February 2014.
017 "The composition of government spending and the multiplier at the Zero Lower Bound" by Julien Albertini, Arthur Poirier and Jordan RoulleauPasdeloup, February 2014.
018 "Interacting Product and Labor Market Regulation and the Impact of Immigration on Native Wages" by Susanne Prantl and Alexandra SpitzOener, February 2014.
SFSBF6B4694, 9S,pSapnadnaduaeureSrtrSatﬂraeﬂ1e, 1D,-D10-1107187B8eBrleinrlin htthpt:t/p/:/s/fbs6fb4694.w9.iwwiiw.hiu.h-bue-brleinrl.idne.de
ThTishrisesreasrecahrcwhawsassupsuppoprtoerdtebdybtyhethDeeDuetsucthseche ForFsocrhsuchnugnsgesgmeeminesicnhsachftatfht rtohuroguhgthhethSeFSBF6B4694"9Ec"oEnconmoimc RicisRki"s.k".

SFB 649 Discussion Paper Series 2014
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
019 "Unemployment benefits extensions at the zero lower bound on nominal interest rate" by Julien Albertini and Arthur Poirier, February 2014.
020 "Modelling spatio-temporal variability of temperature" by Xiaofeng Cao, Ostap Okhrin, Martin Odening and Matthias Ritter, February 2014.
021 "Do Maternal Health Problems Influence Child's Worrying Status? Evidence from British Cohort Study" by Xianhua Dai, Wolfgang Karl H‰rdle and Keming Yu, February 2014.
022 "Nonparametric Test for a Constant Beta over a Fixed Time Interval" by Markus Reiﬂ, Viktor Todorov and George Tauchen, February 2014.
023 "Inflation Expectations Spillovers between the United States and Euro Area" by Aleksei Netsunajev and Lars Winkelmann, March 2014.
024 "Peer Effects and Students' Self-Control" by Berno Buechel, Lydia Mechtenberg and Julia Petersen, April 2014.
025 "Is there a demand for multi-year crop insurance?" by Maria Osipenko, Zhiwei Shen and Martin Odening, April 2014.
026 "Credit Risk Calibration based on CDS Spreads" by Shih-Kang Chao, Wolfgang Karl H‰rdle and Hien Pham-Thu, May 2014.
027 "Stale Forward Guidance" by Gunda-Alexandra Detmers and Dieter Nautz, May 2014.
028 "Confidence Corridors for Multivariate Generalized Quantile Regression" by Shih-Kang Chao, Katharina Proksch, Holger Dette and Wolfgang H‰rdle, May 2014.
029 "Information Risk, Market Stress and Institutional Herding in Financial Markets: New Evidence Through the Lens of a Simulated Model" by Christopher Boortz, Stephanie Kremer, Simon Jurkatis and Dieter Nautz, May 2014.
030 "Forecasting Generalized Quantiles of Electricity Demand: A Functional Data Approach" by Brenda LÛpez Cabrera and Franziska Schulz, May 2014.
031 "Structural Vector Autoregressions with Smooth Transition in Variances ≠ The Interaction Between U.S. Monetary Policy and the Stock Market" by Helmut L¸tkepohl and Aleksei Netsunajev, June 2014.
032 "TEDAS - Tail Event Driven ASset Allocation" by Wolfgang Karl H‰rdle, Sergey Nasekin, David Lee Kuo Chuen and Phoon Kok Fai, June 2014.
033 "Discount Factor Shocks and Labor Market Dynamics" by Julien Albertini and Arthur Poirier, June 2014.
034 "Risky Linear Approximations" by Alexander Meyer-Gohde, July 2014 035 "Adaptive Order Flow Forecasting with Multiplicative Error Models" by
Wolfgang Karl H‰rdle, Andrija Mihoci and Christopher Hian-Ann Ting, July 2014 036 "Portfolio Decisions and Brain Reactions via the CEAD method" by Piotr Majer, Peter N.C. Mohr, Hauke R. Heekeren and Wolfgang K. H‰rdle, July 2014 037 "Common price and volatility jumps in noisy high-frequency data" by Markus Bibinger and Lars Winkelmann, July 2014 038 "Spatial Wage Inequality and Technological Change" by Charlotte Senftleben-Kˆnig and Hanna Wielandt, August 2014 039 "The integration of credit default swap markets in the pre and postsubprime crisis in common stochastic trends" by Cathy Yi-Hsuan Chen, Wolfgang Karl H‰rdle, Hien Pham-Thu, August 2014
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

SFB 649 Discussion Paper Series 2014
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
040 "Localising Forward Intensities for Multiperiod Corporate Default" by Dedy Dwi Prastyo and Wolfgang Karl H‰rdle, August 2014.
041 "Certification and Market Transparency" by Konrad Stahl and Roland Strausz, September 2014.
042 "Beyond dimension two: A test for higher-order tail risk" by Carsten Bormann, Melanie Schienle and Julia Schaumburg, September 2014.
043 "Semiparametric Estimation with Generated Covariates" by Enno Mammen, Christoph Rothe and Melanie Schienle, September 2014.
044 "On the Timing of Climate Agreements" by Robert C. Schmidt and Roland Strausz, September 2014.
045 "Optimal Sales Contracts with Withdrawal Rights" by Daniel Kr‰hmer and Roland Strausz, September 2014.
046 "Ex post information rents in sequential screening" by Daniel Kr‰hmer and Roland Strausz, September 2014.
047 "Similarities and Differences between U.S. and German Regulation of the Use of Derivatives and Leverage by Mutual Funds ≠ What Can Regulators Learn from Each Other?" by Dominika Paula Galkiewicz, September 2014.
048 "That's how we roll: an experiment on rollover risk" by Ciril Bosch-Rosa, September 2014.
049 "Comparing Solution Methods for DSGE Models with Labor Market Search" by Hong Lan, September 2014.
050 "Volatility Modelling of CO2 Emission Allowance Spot Prices with RegimeSwitching GARCH Models" by Thijs Benschopa, Brenda LÛpez Cabrera, September 2014.
051 "Corporate Cash Hoarding in a Model with Liquidity Constraints" by Falk Mazelis, September 2014.
052 "Designing an Index for Assessing Wind Energy Potential" by Matthias Ritter, Zhiwei Shen, Brenda LÛpez Cabrera, Martin Odening, Lars Deckert, September 2014.
053 "Improved Volatility Estimation Based On Limit Order Books" by Markus Bibinger, Moritz Jirak, Markus Reiss, September 2014.
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

